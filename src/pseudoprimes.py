# Copyright 2025 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

import math
import mod_arith
import os
import flag
import collections

def randomint(a: int, b: int) -> int:
  """Returns a random integer in a given range.

  Args:
    a: the lower bound (inclusive)
    b: the upper bound (exclusive)

  Returns:
    the random integer
  """
  d = b-a
  assert d > 0
  bytes = 8 + d.bit_length() // 8
  res = 0
  for x in os.urandom(bytes):
    res = (res << 8) + x
  return a + res % d



# TODO:
#   list of primes
# add special cases for integer overflows:
#   i.e. both composites and primes.
# CVE's:
#   CVE-2014-9742: Botan used a single base for MR.
#   CVE-2016-0701: The DH_check_pub_key function in crypto/dh/dh_check.c in
#                  OpenSSL 1.0.2 before 1.0.2f does not ensure that prime
#                  numbers are appropriate for Diffie-Hellman
#                  (maybe a DH issue)
# Some more papers:
#   A Security Flaw in the X.509 Standard, Santosh Chokhani
#   http://csrc.nist.gov/nissc/1996/papers/NISSC96/paper075/paper.pdf
#   contains some minor points on verifying p,q in DSS.
#   https://crocs.fi.muni.cz/_media/publications/pdf/esorics2020_pseudoprimes_final.pdf
#   Also contains some code:
#   https://github.com/crocs-muni/fooling-primality-tests
# NIST describes a Miller-Rabin version with an infinite loop for
#   n = 3
# Add more primes.


def is_strong_pseudoprime(n: int, b: int) -> bool:
  """Determines if n is strong pseudoprime to basis b.

  Args:
    n: the integer to test
    b: the basis

  Returns:
    True if n is a strong pseudoprime to basis b.
  """
  if n < 2 or n % 2 == 0: return False
  m = n-1
  s = 0
  while m%2==0:
    m //= 2
    s += 1
  t = pow(b, m, n)
  if t == 1 or t == n-1: return True
  for i in range(s-1):
    t = t * t % n
    if t == n-1: return True
  return False

def luc(m: int, p: int, q: int, mod: int) -> tuple[int, int]:
  """Computes generalized Lucas and Fibonacci sequences.

  Args:
    m: the index
    p: parameter of the sequence
    q: parameter of the sequence
    mod: the modulus

  Returns:
    the values (u_m, v_m)
  """
  if m <= 0:
    raise ValueError("m must be positive")
  if mod % 2 != 1:
    raise ValueError("mod must be odd")
  d = 1 - 4 * q
  inv2 = (1 + mod) // 2
  u, v = 1, p
  for j in range(m.bit_length() - 2, -1, -1):
    u, v = u * v % mod, (v * v + d * u * u) * inv2 % mod
    if (m >> j) & 1:
      u, v = p*(u + v) * inv2 % mod, (d * u + p * v) * inv2 % mod
  return u, v


def is_lucas_pseudoprime(n: int, d: int) -> bool:
  """Checks whether n is a Lucas pseudoprime for d as defined in the PSW test.

  Args:
    n: the integer to check
    d: the parameter d, must be congruent 1 modulo 4 and a quadratic
      non-residue.

  Returns:
    whether n is a Lucas-pseudoprime.
  Raises:
    ValueError: if d is incorrect
  """
  if d % 4 != 1:
    raise ValueError("Not implemented")
  if mod_arith.jacobi(d, n) != -1:
    raise ValueError("incorrect d")
  p, q = 1, (1 - d) // 4
  u, v = luc(n + 1, p, q, n)
  return u == 0


def is_strong_lucas_pseudoprime(n: int, d : int) -> bool:
  """ Checks whether n is a "strong" Lucas pseudoprime.

  This is a Lucas pseudoprime test that additionally checks the value v,
  since this value is computed anyway and hence the additional check is
  essetially free.
  Not sure if that is called strong lucas pseudoprime.

  Args:
    n: the integer to check
    d: the parameter d, must be congruent 1 modulo 4 and a quadratic
      non-residue.

  Returns:
    whether n is a "strong" Lucas-pseudoprime.
  Raises:
    ValueError: if d is incorrect
  """
  if d % 4 != 1:
    raise ValueError("Not implemented")
  if mod_arith.jacobi(d, n) != -1:
    raise ValueError("incorrect d")
  p, q = 1, (1-d)//4
  u,v = luc(n + 1, p, q, n)
  return u == 0 and v == 4


def spsp_bases(n: int, maxb: int) -> list[int]:
  """Returns a list of bases to which n is strong pseudoprime."""
  return [i for i in range(2, maxb + 1) if is_strong_pseudoprime(n, i)]


def psw_test(n: int) -> bool:
  """Baillieâ€“PSW primality test

  https://en.wikipedia.org/wiki/Baillie%E2%80%93PSW_primality_test
  """
  if n < 2: return False
  for p in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31):
    if p*p > n: return True
    if n%p==0: return False
  if not is_strong_pseudoprime(n, 2):
    return False
  if mod_arith.is_square(n):
    return False
  D = 5
  while mod_arith.jacobi(D, n) != -1:
    if D > 0:
      D = -D - 2
    else:
      D = -D + 2
  return is_lucas_pseudoprime(n, D)


def is_probable_prime(n: int) -> bool:
  """A probabilistic primality test.

  Args:
    n: the integer to test

  Returns:
    True if n is probable prime, False if n < 2 or composite.
  """
  if not isinstance(n, int):
    return False
  if n < 2: return False
  for p in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31):
    if p * p > n: return True
    if n % p == 0: return False
  for _ in range(25):
    b = randomint(2, n-1)
    if not is_strong_pseudoprime(n, b):
      return False
  return True


def factor(n: int) -> list[int]:
  """Simple integer factorization.

  Just function just uses trial division.

  Args:
    n: the integer to factor
  Returns:
    a list of prime factors. a prime factor p
    appears k time if p**k divides n.
  """
  if n <= 0:
    raise ValueError("Not implemented")
  res = []
  while n % 2 == 0:
    res.append(2)
    n//=2
  p = 3
  while True:
    q, r = divmod(n, p)
    if r == 0:
      res.append(p)
      n = q
    elif q < p:
      break
    else:
      p += 2
  if n != 1:
    res.append(n)
  return res


def are_probable_primes(L):
  """Returns True if all integers in L are probable primes.

  The test reorders the checks in is_probable_prime to   allow a fast rejection
  if one of the integers in L is
  not prime.
  """
  for n in L:
    if not isinstance(n, int) or n < 2:
      return False
  for n in L:
    for p in (2,3,5,7,11,13,17,19,23,29,31):
      if p * p > n: break
      if n%p==0: return False
  for _ in range(25):
    for n in L:
      b = randomint(2,n-1)
      if not is_strong_pseudoprime(n, b):
        return False
  return True

# BUGS:
small_number_of_mr_tests = flag.Flag(
    label="SmallNumberOfMillerRabinTests",
    bug_type=flag.BugType.MISSING_STEP,
    description="The paper "
    '"Average case error estimates for the strong probable prime test" by '
    "Damgard, I.; Landrock, P. & Pomerance, C. (1993), Math. of Comp., 61 (203) "
    "determines an error bound for testing random integers. These bounds are "
    "sometimes used for verifying a prime number. The results no longer hold "
    "since an adversary can choose a worst case integer. I.e., it is possible "
    "to generate composite integers that pass a Miller-Rabin Test with "
    "a probability of about 1/4. "
    "This test vector contains such a worst case for the Miller-Rabin Test. ")

fixed_mr_basis = flag.Flag(
    label="FixedMillerRabinBasis",
    bug_type=flag.BugType.MISSING_STEP,
    description="The Miller-Rabin test should be performed with random bases. "
    "If instead the test is performed with a predefined set of bases then it "
    "may be possible to find composites that pass the test. "
    "This test vector contains a composite number that was constructed to "
    "pass a test with a fixed set of bases.")

carmichael = flag.Flag(
    label="CarmichaelNumber",
    bug_type=flag.BugType.MISSING_STEP,
    description="This test vectors contains a Carmichael number. "
    "Carmichael numbers pass the Fermat test for any base. "
    "Because of this property the Fermat test should not be uses "
    "as a probable prime test. Other tests such as the Miller-Rabin "
    "test are preferable.")

bound_deterministic = flag.Flag(
    label="BoundDeterministic",
    bug_type=flag.BugType.MISSING_STEP,
    description="Some implementations use strong pseudoprime tests "
    "with a fixed set of bases for small integers. The upper bounds for "
    "such tests are sometimes wrong. This test vector contains an "
    "edge case for this method.")

fermat2 = flag.Flag(
    label="FermatTest",
    bug_type=flag.BugType.MISSING_STEP,
    description="The test vector contains an integer that passes a "
    "simple Fermat test with basis 2. Such a test is sometimes used "
    "for simple scanning. It not not sufficient as a probably primality "
    "test.")

small_integer = flag.Flag(
    label="SmallInteger",
    bug_type=flag.BugType.BASIC,
    description="The test vector contains a small integer. Implementations "
    "often use special case code for such cases.")


class Product:

  def __init__(self, *factors: int, flags: list[flag.Flag] = []):
    self.factors = factors
    self.known_flags = flags[:]
    n = 1
    for x in self.factors:
      n *= x
    self.n = n

  def __repr__(self):
    args = ", ".join(str(f) for f in self.factors)
    return f"Product({args})"

  def __str__(self):
    return "*".join(str(x) for x in self.factors)

  def __int__(self):
    return self.n

  def max_order(self):
    res = 1
    for p, e in collections.Counter(self.factors).items():
      res = math.lcm(res, (p - 1) * p**(e - 1))
    return res

  def flags(self) -> list[flag.Flag]:
    flags = self.known_flags[:]
    if (self.n - 1) % self.max_order() == 0:
      flags.append(carmichael)
    elif pow(2, self.n, self.n) == 2:
      flags.append(fermat2)
    return flags

def random_prime(a: int, b: int) -> int:
  """Returns a random odd prime in the range a, b.
     Doesn't check if primes actuall exist.
     Doesn't guarantee that the primes are uniformly distributed."""
  while True:
    p = randomint(a, b) | 1
    if p >= b: continue
    if is_probable_prime(p):
      return p

def random_prime_in_residue_class(
   lower: int,
   upper: int,
   modulus: int,
   remainder: int) -> int:
  """Returns a prime with lower <= p < upper and p % modulus == remainder

  Args:
    lower: the lower bound
    upper: the upper bound
    modulus: the modulus
    remainder: the remainder
  Returns:
    a probable prime
  Raises:
    ValueError: when parameters are wrong.
  """
  if math.gcd(modulus, remainder) != 1:
    raise ValueError("modulus and remainder must be coprime")
  mink = (lower - remainder) // modulus
  maxk = (upper - remainder + modulus - 1) // modulus
  while True:
    k = randomint(mink, maxk)
    p = k * modulus + remainder
    if is_probable_prime(p):
      return p


def gen_psp_2factor(bits: int, sieve_size: int = 100000) -> Product:
  """Generates a pseudoprime n that probably has the following properties:
     (Note, we don't do real primality tests here)
     (1) n = p*q  where p.bit_length() == bits, q = 2*p-1
     (2) n passes MR for about 1/4 of all bases."""
  # unique solutions
  if bits == 3:
    return Product(7, 13)
  if bits == 5:
    return Product(19, 37)
  if bits == 6:
    return Product(31, 61)
  if bits == 7:
    return Product(79, 157)
  assert bits >= 8
  while True:
    if 2 ** (bits - 2) <= sieve_size:
      m = 2 ** (bits - 2)
      sieve_size = 2 ** (bits - 2)
    else:
      m = randomint(2**(bits-2), 2**(bits-1) - sieve_size)
    # Set D[i] = True if either (2*(m+i)+1) or (4*(m+i)+1) is divisible.
    D = [False]*sieve_size
    for d in xrange(3, sieve_size, 2):
      # 2*(m+i)+1 divisible by d if
      # i == -(1+2*m+d)/2 (mod d)
      r1 = -(1+2*m+d)//2 % d
      for x in range(r1, sieve_size, d): D[x] = True
      # 4*(m+i)+1 divisible by d if
      # 2*i == -(1+4*m+d)/2 (mod d)
      ii = -(1+4*m+d)//2 % d
      r2 = (ii + d * (ii % 2))//2
      for x in range(r2, sieve_size, d): D[x] = True
    offset = randomint(0, sieve_size)
    for j in range(sieve_size):
      i = (j + offset) % sieve_size
      p = 2*(m+i) + 1
      q = 4*(m+i) + 1
      n = p*q
      if pow(2, p, p) == 2 and pow(2, q, q) == 2 and pow(3, n, n) == 3:
        return Product(p, q)


def gen_psp(bits, cnt) -> Product:
  from time import time
  start = time()
  for i in range(cnt):
    x = gen_psp_2factor(bits)
    print(x)
  g4print((time()-start)/cnt)



def gen_carmichael(a: int, b: int, c: int, m0: int) -> Product:
  """Generates 3-prime Carmichael numbers of the form

     n = (a*m + 1) * (b*m + 1) * (c*m + 1).
     where m >= m0

     n is Carmichael iff it is square free and satisfies
     p-1 | n-1 for every prime divisor p. For the form above
     this implies that a divides bc m + b + c.

     Args:
        a: the first prime factor is a*m + 1. a must be coprime to b and c.
        b: the second prime factor is b*m + 1. b must be coprime to a and c.
        c: the thrid prime factor is c*m + 1. c must be coprime to a and b.
  """
  if math.gcd(a, b) != 1:
    raise ValueError("a and b not coprime")
  if math.gcd(a, c) != 1:
    raise ValueError("a and c not coprime")
  if math.gcd(b, c) != 1:
    raise ValueError("b and c not coprime")
  res_a = (b + c) * pow(-b * c, -1, a) % a
  res_b = (a + c) * pow(-a * c, -1, b) % b
  res_c = (a + b) * pow(-a * b, -1, c) % c
  res_ab = mod_arith.chrem(res_a, a, res_b, b)
  res_abc = mod_arith.chrem(res_ab, a * b, res_c, c)

  step = a * b * c
  m = m0 + (res_abc - m0) % step
  assert m % (a*b*c) == res_abc
  # Just consider odd n's:
  if step % 2 == 1:
    if m % 2 == 1:
      m += step
    step *= 2
  while True:
    p = a * m + 1
    q = b * m + 1
    r = c * m + 1
    if are_probable_primes([p, q, r]):
      return Product(p, q, r)
    m += step


# Format: ("comment", flag, List[int])
# Flag: [label, desc, link] or None
# new Format: (description: str   # e.g. strong pseudoprime,
#              label: str         #


Jaeschke93 = [
    "Jaeschke93",
    'G. Jaeschke: "On strong pseudoprimes to several bases", Math o. comp. '
    "v.61, p 915-926, 1993", None
]

SorWeb15 = [
    "SorWeb15",
    ("J. Sorenson and J. Webster, "
     '"Strong pseudoprimes to 12 or more bases",'),
    "https://arxiv.org/pdf/1509.00864.pdf"
]

Pinch93 = [
    "Pinch93",
    'Richard G.E. Pinch, "Some primality testing algorithms"',
    None,
]

Howe98 = [
    "Howe98",
    'Everett W. Howe, "Higher order Carmichael Numbers"',
    "https://arxiv.org/abs/math/9812089",
]

Bleichen05 = [
    "Bleichen05",
    "Breaking a Cryptographic Protocol with Pseudoprimes",
    "http://www.iacr.org/archive/pkc2005/33860010/33860010.pdf",
]

PinchAbsoluteQuadratic = [
    "Pinch",
    'Richard G.E. Pinch, "Absolute quadratic pseudorprimes" ',
    "http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.210.6783&rep=rep1&type=pdf",
]

GaMaPa19 = [
    "GaMaPa19",
    ('Galbraith, Massimo, Paterson, Safety in Numbers: "On the Need for Robust'
     ' Diffie-Hellman Parameter Validation"'
    ),
    " https://eprint.iacr.org/2019/032.pdf",
]

Mueller = [
    "Mueller",
    'S. Mueller, "Strong Dickson Pseudoprimes which are not Fermat Carmichael '
    'Numbers"',
    None,
]

Arnault96 = [
    'Arnault96',
    'A strong pseudoprime for the first 46 primes. F. Arnault, "Rabin-Miller '
    'primality test: composite numbers which pass it", Math. comp. v.64, '
    'n.209, p 355-361.',
    None,
]



# format: comment, ref, bug, list of products
# BUGS:
# known bug
#
NONPRIMES = [
    ("small non prime integer", None, [small_integer], [
        -1,
        0,
        1,
    ]),
    ("negative composite integer", None, [small_integer], [
        -4,
        -25,
        -561,
        Product(-1, 3511, 3511),
        -27699407,
    ]),
    ("Non-prime Mersenne number that is pseudoprime to base 2", None, None, [
        Product(193707721, 761838257287),
        Product(228479, 48544121, 212885833),
    ]),
    ("Non-prime Fermat number", None, None, [
        Product(59649589127497217, 5704689200685129054721),
        Product(1238926361552897,
                93461639715357977769163558199606896584051237541638188580280321),
        Product(
            2424833, 7455602825647884208337395736200454918783366342657,
            741640062627530801524787141901937474059940781097519023905821316144415759504705008092818711693940737
        ),
    ]),
    ("pseudoprime square derived from Wiefrich prime", None, [small_integer], [
        Product(1093, 1093),
        Product(3511, 3511),
    ]),
    ("square", None, [small_integer], [
        Product(2, 2),
        Product(3, 3),
        Product(257, 257),
        Product(997, 997),
    ]),
    ("strong pseudoprime", Jaeschke93, [fixed_mr_basis], [
        Product(6763, 10627, 29947),
        Product(1303, 16927, 157543),
        Product(10670053, 32010157),
        Product(4540612081, 9081224161),
        Product(22754930352733, 68264791058197),
        Product(137716125329053, 413148375987157),
    ]),
    ("counter example for Maple", Pinch93, None, [
        Product(3739, 18691, 153259),
        Product(46411, 232051, 417691),
        Product(21319, 106591, 3005839),
    ]),
    ("counter example for Mathematica 2.0", Pinch93, None, [
        Product(89, 11551, 37159),
        Product(7309, 321553, 2828197),
    ]),
    ("counter example Axiom", Pinch93, None, [
        Product(266420043451, 4674035851, 135547039651),
        Product(18215745452589259639, 4337082250616490391, 867416450123298079),
    ]),
    ("higher order Carmichael number", Howe98, None, [
        Product(17, 31, 41, 43, 89, 97, 167, 331),
        Product(31, 37, 101, 103, 109, 199, 419, 449, 521, 571, 911, 2089, 2551,
                5851, 11969),
        Product(41, 67, 79, 181, 199, 233, 239, 307, 449, 521, 1217, 1871, 4159,
                5851, 9281),
        Product(61, 67, 71, 89, 101, 103, 113, 151, 181, 191, 199, 233, 239,
                271, 307, 419, 463, 521, 571, 701, 911, 5279),
        Product(23, 67, 71, 89, 109, 113, 191, 199, 233, 239, 271, 307, 373,
                419, 521, 911, 929, 1153, 1217, 1429, 2089, 2729, 23561),
    ]),
    ("counter example for Gnu Crypto", Bleichen05, None, [
        Product(398462957079251, 28278016308851, 268974870654491, 1239515532971,
                12941222544251, 2825874899, 182200861571, 480965007251,
                8028415890251, 761874633627251, 10326412038251, 105324823451,
                7128348371, 29542620251, 251906132167691, 64654312451,
                226698699371, 130685132579, 9167201891, 432876391197251,
                3077983389251, 17767646051, 9371850251, 954045342251,
                112810627931, 6297653304192251, 20842025454251),
    ]),
    ("Worst case for Miller-Rabin test", None, [small_number_of_mr_tests], [
        Product(
            9302220471865827333247195510400390810859984737819696231647619716858636660759405937490819353783924759896510569421165856066014865080829225165369771958515551,
            18604440943731654666494391020800781621719969475639392463295239433717273321518811874981638707567849519793021138842331712132029730161658450330739543917031101
        ),
        Product(
            8249238931331770392591025391616801881470136300721220356749129296103468908416293757912419059804261031926442031556555536497721563532437954679320705426513731,
            16498477862663540785182050783233603762940272601442440713498258592206937816832587515824838119608522063852884063113111072995443127064875909358641410853027461
        ),
        Product(
            12583488697662235303045360350318066087995671271950155260016168541612806691209370061468962113983450426005135488994688986830430265072376470800956443153698087,
            25166977395324470606090720700636132175991342543900310520032337083225613382418740122937924227966900852010270977989377973660860530144752941601912886307396173
        ),
        Product(
            9663997464886842625604300499302398736344838329270020729205519993958206761166322046125596632693431382752141945332629172909074079640303659622820555393473359,
            19327994929773685251208600998604797472689676658540041458411039987916413522332644092251193265386862765504283890665258345818148159280607319245641110786946717
        ),
        Product(
            9477316764947264539632492430046220491017826218220798231435193492789750474749913350457780183399807037132545052038054724454418488947416314616729379928554057,
            18954633529894529079264984860092440982035652436441596462870386985579500949499826700915560366799614074265090104076109448908836977894832629233458759857108113
        ),
        Product(
            9929615402561207051453851245437473504862407243282034817810560744226268966925266144264076876897733301599744932235287893493545369173447639708207128819153071,
            19859230805122414102907702490874947009724814486564069635621121488452537933850532288528153753795466603199489864470575786987090738346895279416414257638306141
        ),
        Product(
            12549916598295507571094078748232399307529385679821601574768727701967670384468863495459459572012407675854660567995391328989413758236434961162714392860360287,
            25099833196591015142188157496464798615058771359643203149537455403935340768937726990918919144024815351709321135990782657978827516472869922325428785720720573
        ),
        Product(
            9243771152419726365138723851083001704796277066677638817160485798013363907600304103687795975550365061504785121799286954232778097297370416816927257864731621,
            18487542304839452730277447702166003409592554133355277634320971596026727815200608207375591951100730123009570243598573908465556194594740833633854515729463241
        ),
        Product(
            13114884105461005111846896173030801895366424251188245969441684992069284252888907967476319275391431110036539148767416780876164331211214374075833697878679141,
            26229768210922010223693792346061603790732848502376491938883369984138568505777815934952638550782862220073078297534833561752328662422428748151667395757358281
        ),
        Product(
            8320123476960022613204997370915851186019622477712250750889464856591393979688105621492263372284502571118724064988663645601041754359052369845310963486252571,
            16640246953920045226409994741831702372039244955424501501778929713182787959376211242984526744569005142237448129977327291202083508718104739690621926972505141
        ),
        Product(
            12578540988986100834429529919054544875420581990048688795383958309061205175447849248344695117149571966362171128532686510896048444980543844220264073002305191,
            25157081977972201668859059838109089750841163980097377590767916618122410350895698496689390234299143932724342257065373021792096889961087688440528146004610381
        ),
        Product(
            13095058191945237810330344610072087984876479365048785210803126721923297925889621506265854236574074756088058967508873611573087670616344261123417810689158441,
            26190116383890475620660689220144175969752958730097570421606253443846595851779243012531708473148149512176117935017747223146175341232688522246835621378316881
        ),
        Product(
            8522399813050024890359433083384066361465502734653407127028782651342596024067756326787488972704522063012836174465593584108433763350532755392651317856438481,
            17044799626100049780718866166768132722931005469306814254057565302685192048135512653574977945409044126025672348931187168216867526701065510785302635712876961
        ),
        Product(
            7206801315170168919619217860454300253601755388761492361622992708774583412715767166482189627383838059192157743454075316482841045184847889765838087559305257,
            14413602630340337839238435720908600507203510777522984723245985417549166825431534332964379254767676118384315486908150632965682090369695779531676175118610513
        ),
        Product(
            10228946300443383420171676214378176393098575589263799867737995818757827925559351714021199787400694650445001952014896101513776526263109762670208606037958139,
            20457892600886766840343352428756352786197151178527599735475991637515655851118703428042399574801389300890003904029792203027553052526219525340417212075916277
        ),
        Product(
            11400920447320230095892504661431459354383787145212636882618172295312296263999731221105662700357353975863868576526753273808458408935436083734689971872598067,
            22801840894640460191785009322862918708767574290425273765236344590624592527999462442211325400714707951727737153053506547616916817870872167469379943745196133
        ),
        Product(
            8616681855653698283924160403510581498246396206159977359805778301489439797338561483245702348285707770939416673518409926594269016935483819332433013379948059,
            17233363711307396567848320807021162996492792412319954719611556602978879594677122966491404696571415541878833347036819853188538033870967638664866026759896117
        ),
        Product(
            9973761170876339089460968945850175940306666083729861689402371237509107772536377867589606418883418996090618671125609015738915735892710544759378711765361707,
            19947522341752678178921937891700351880613332167459723378804742475018215545072755735179212837766837992181237342251218031477831471785421089518757423530723413
        ),
        Product(
            7076427592622318213719445355590866343155983001831055334631719656179022605528187756338945470969795022633173298124868191781832493513646695476778026073758099,
            14152855185244636427438890711181732686311966003662110669263439312358045211056375512677890941939590045266346596249736383563664987027293390953556052147516197
        ),
        Product(
            6900406024017589291731943712196629547153415338075260637043071694451851948825004379877582905189307462228963493480917034354978529888894783680175441481767559,
            13800812048035178583463887424393259094306830676150521274086143388903703897650008759755165810378614924457926986961834068709957059777789567360350882963535117
        ),
        Product(
            7525599298831258062879122554980450329812287159242668174745085840560770129297514810664808264493413145200748080317714373566260216627321763212339071266529729,
            15051198597662516125758245109960900659624574318485336349490171681121540258595029621329616528986826290401496160635428747132520433254643526424678142533059457
        ),
        Product(
            8568776007527667559286712369227346076340467988818199765392812853921094713637425922303840130478420540059112984732045428648467158016799016462478349217894939,
            17137552015055335118573424738454692152680935977636399530785625707842189427274851844607680260956841080118225969464090857296934316033598032924956698435789877
        ),
        Product(
            13386799659028457391647039848332760084932099879201656462734813108511001749130636444602167163039912001386157964681110158809802566274469035462366952897641659,
            26773599318056914783294079696665520169864199758403312925469626217022003498261272889204334326079824002772315929362220317619605132548938070924733905795283317
        ),
        Product(
            8258730352572970556733149348249498643190730242177534187848983128897332490544868860900766336514526092919144824296074425713670224243444389229489437084161281,
            16517460705145941113466298696498997286381460484355068375697966257794664981089737721801532673029052185838289648592148851427340448486888778458978874168322561
        ),
        Product(
            7749880937066506757869070545219230046711268866074749763195071143034259593634206435909965111855343565434463262315848821680734253944043664659454938687418749,
            15499761874133013515738141090438460093422537732149499526390142286068519187268412871819930223710687130868926524631697643361468507888087329318909877374837497
        ),
        Product(
            11725211352012416940989644350485117833888736677645442285842441350018115085358416275370710852596583997325571932069522909277982829638151290587155679406831107,
            23450422704024833881979288700970235667777473355290884571684882700036230170716832550741421705193167994651143864139045818555965659276302581174311358813662213
        ),
        Product(
            11119761946062841322620806110133378725023659377252788191932228709459835344553826675356814817909887561980294092234066326391410631473695519231470544406753581,
            22239523892125682645241612220266757450047318754505576383864457418919670689107653350713629635819775123960588184468132652782821262947391038462941088813507161
        ),
        Product(
            9657502753988243056455716416702071594867015640112927131181676611325201969044652819927485827022100676667587674435182068801014940652433200979033687530839321,
            19315005507976486112911432833404143189734031280225854262363353222650403938089305639854971654044201353335175348870364137602029881304866401958067375061678641
        ),
        Product(
            11941986147712590794559242287571422310420819663762527078359439935104808313843367808711837697918481995052366843974992672964060572161029197082793307737529007,
            23883972295425181589118484575142844620841639327525054156718879870209616627686735617423675395836963990104733687949985345928121144322058394165586615475058013
        ),
        Product(
            9519104332175938095095460058289771645036210264317252653472412150339213337280828560872591280281700392906226966376767685440489893744137464070076985956339977,
            19038208664351876190190920116579543290072420528634505306944824300678426674561657121745182560563400785812453932753535370880979787488274928140153971912679953
        ),
        Product(
            13155755434122910681260835532563496106132655798457223641065828245286399410210593708817894899682560756831383491419881931056768465504692040986059112294008251,
            26311510868245821362521671065126992212265311596914447282131656490572798820421187417635789799365121513662766982839763862113536931009384081972118224588016501
        ),
        Product(
            12083004181432009789440722452638201864900781963433279184477399868640135496271007458437644678446889212960021121680160552758972341903333848621458583245869541,
            24166008362864019578881444905276403729801563926866558368954799737280270992542014916875289356893778425920042243360321105517944683806667697242917166491739081
        ),
        Product(
            1439644862101243967776186247013207993286229791809409870570228723421410829638104421515504446877292504939171090905996748819424697386173441909318046732573372771430854002523454370872692452861004167,
            2879289724202487935552372494026415986572459583618819741140457446842821659276208843031008893754585009878342181811993497638849394772346883818636093465146745542861708005046908741745384905722008333
        ),
        Product(
            1905724361496906891866590715997758949430313626097769220741800557183619174691557056387087652761033060861294299998818498482196789551426107654018813054802394232456019051029870195706248586318479709,
            3811448722993813783733181431995517898860627252195538441483601114367238349383114112774175305522066121722588599997636996964393579102852215308037626109604788464912038102059740391412497172636959417
        ),
        Product(
            1278018655822643816802747577084006239663128880959389714509844530375297437003967318397508988480261835200747316838634928355565245360715712927332675444383995946014059350422539647933863286056319269,
            2556037311645287633605495154168012479326257761918779429019689060750594874007934636795017976960523670401494633677269856711130490721431425854665350888767991892028118700845079295867726572112638537
        ),
        Product(
            1164962457511683567782842957247359154167715532782514399612884675819153015961794204759172079578403407394827983763978597614109428353871754979756316298088514995550542984195228411489801339067874181,
            2329924915023367135565685914494718308335431065565028799225769351638306031923588409518344159156806814789655967527957195228218856707743509959512632596177029991101085968390456822979602678135748361
        ),
        Product(
            2152554742526606591265154433329208517938349676973665499079162244059917632509154593541204581002977743170479238869859876383265221756147343015834611973196853613266648952821992799535403362824956529,
            4305109485053213182530308866658417035876699353947330998158324488119835265018309187082409162005955486340958477739719752766530443512294686031669223946393707226533297905643985599070806725649913057
        ),
        Product(
            1863288203682150858125910961455361385616731946166720706943118653160473660804354090594171445161750049051244513800946742417027775913736593937285545551786092020558886963618463397979729170966210827,
            3726576407364301716251821922910722771233463892333441413886237306320947321608708181188342890323500098102489027601893484834055551827473187874571091103572184041117773927236926795959458341932421653
        ),
        Product(
            2085365525688305156153386793813962402679668052105792243560286616051543496448186483357585944854737581474575078666633048619128952826255432769588040201040085279265979614945830164971097044185784741,
            4170731051376610312306773587627924805359336104211584487120573232103086992896372966715171889709475162949150157333266097238257905652510865539176080402080170558531959229891660329942194088371569481
        ),
        Product(
            1458105245403647945685538210786998923235791089350439696771320811886088552011820808696075775187268678936966908646104772507277180201649549892716893025567960610761304664788084685514541931435110399,
            2916210490807295891371076421573997846471582178700879393542641623772177104023641617392151550374537357873933817292209545014554360403299099785433786051135921221522609329576169371029083862870220797
        ),
        Product(
            1295501331204046074682094363779622382091200897611183627218927443870664818509580122349010919190582960387705869467059575404155672641545295150431469284905063536593955322360070189942927920329594221,
            2591002662408092149364188727559244764182401795222367254437854887741329637019160244698021838381165920775411738934119150808311345283090590300862938569810127073187910644720140379885855840659188441
        ),
        Product(
            1357778622462002258942811628481544220106040232372409670763170910893338490912553088498187074536768982768920305631130363631325834774688671933873136064517105936342307127595981567593625286014068649,
            2715557244924004517885623256963088440212080464744819341526341821786676981825106176996374149073537965537840611262260727262651669549377343867746272129034211872684614255191963135187250572028137297
        ),
        Product(
            1744786629497182938249862470522189262583367565258981239799854354917586673526286161752526277974850588742699552419627109631509806476148887922128078736560541845216098942524326796361817452293604477,
            3489573258994365876499724941044378525166735130517962479599708709835173347052572323505052555949701177485399104839254219263019612952297775844256157473121083690432197885048653592723634904587208953
        ),
        Product(
            1743812815060564631284042802262783731203244655536478440786180702057608017492749757076592792702322703124808238337598062557987211267182384699942053518995438788025667144718168318870872164828008649,
            3487625630121129262568085604525567462406489311072956881572361404115216034985499514153185585404645406249616476675196125115974422534364769399884107037990877576051334289436336637741744329656017297
        ),
        Product(
            1581277832143976665758763230143205010455311773461328635549570010104298747225160477268330464359218013095043426089742605895371703377853836065163604373845765453814239228977086584978239034197729049,
            3162555664287953331517526460286410020910623546922657271099140020208597494450320954536660928718436026190086852179485211790743406755707672130327208747691530907628478457954173169956478068395458097
        ),
        Product(
            1586452098878809947243483533387175584217204554445902062654895178426796433013387996996818119127036764505533603142000867678263645332080151560485832097693200588791939915103387620547492676676324171,
            3172904197757619894486967066774351168434409108891804125309790356853592866026775993993636238254073529011067206284001735356527290664160303120971664195386401177583879830206775241094985353352648341
        ),
        Product(
            1956616016792190011384739567184878422541552353336817234912692910019704262421408246239559299374728221006476402500023886971708433475009994623100875206236301270674452538835359995805485450583941151,
            3913232033584380022769479134369756845083104706673634469825385820039408524842816492479118598749456442012952805000047773943416866950019989246201750412472602541348905077670719991610970901167882301
        ),
        Product(
            1859644112404993747338743766730830216242282921693881271194641789354765402185384339690291720278395830814106011785734446069171232554003916557947783764347131892547384283695820741221994560948433131,
            3719288224809987494677487533461660432484565843387762542389283578709530804370768679380583440556791661628212023571468892138342465108007833115895567528694263785094768567391641482443989121896866261
        ),
    ]),
    ('strong pseudoprime for 46 bases', Arnault96, None, [
        Product(
            2004791083197498027091532260422734265025940830205662543872531023690016085350598121358111595798609866791081582542679083484572616906958584643763990222898400226296015918301,
            4009582166394996054183064520845468530051881660411325087745062047380032170701196242716223191597219733582163165085358166969145233813917169287527980445796800452592031836601
        ),
    ]),
    ('Absolute quadratic pseudoprime', PinchAbsoluteQuadratic, None, [
        Product(29, 31, 67, 271, 331, 5237),
        Product(17, 31, 41, 43, 89, 97, 167, 331),
        Product(41, 53, 79, 103, 239, 271, 509),
        Product(17, 23, 29, 31, 79, 89, 181, 1999),
        Product(17, 37, 41, 131, 251, 571, 4159),
        Product(11, 19, 31),
        Product(29, 41, 71),
        Product(89, 109, 199),
        Product(37, 41, 43, 109),
        Product(5, 13, 17, 113, 127),
        Product(13, 47, 137, 239, 3163),
        Product(23, 29, 41, 43, 251, 269),
    ]),
    ("counter example for Diffie-Hellman validation", GaMaPa19, None, [
        Product(19, 23, 43, 239, 859, 9283, 11467, 242551),
        Product(7614578295977916492449157442324119319,
                9306706806195231268548970207285034723,
                17767349357281805149048034032089611743,
                100681646357930229177938859515174466539,
                362961565441614019473409838084116354159,
                3926584207959278937939615521091804194983,
                4850486374537932805690113290760464005567,
                102606442538302424735752396535317507810051),
        Product(219186431519361672882122216610071,
                407060515678814535352512687990131,
                2022777639450109152597870741858647,
                5855408956302947546993836358011871,
                14159443476150764068185095193010523,
                14873364995956684945572578984254751,
                146385223907573688674845908950296751,
                1097028089754405172775021694133400351,
                1353476214632058330047104687567182251),
        Product(149185389210558730480951523, 474680783851777778803027571,
                1288419270454825399608217691, 2834522395000615879138078919,
                3322765486962444451621192991, 26107443111847777834166516351,
                30664378636824844510675581023, 32210481761370634990205442251,
                63132544252286444580802666811, 117246153611389111364347809791,
                766609465920621112766889525551),
        Product(12096932041680954958693771, 36290796125042864876081311,
                133066252458490504545631471),
        Product(2758736250382478263, 8276208751147434787, 30346098754207260883,
                91038296262621782647),
    ]),
    ("strong pseudoprime to 12 bases", SorWeb15, [fixed_mr_basis], [
        Product(747451, 149491, 34233211),
        Product(787711, 214831, 1360591),
        Product(424665351661, 849330703321),
        Product(286600958341, 573201916681),
        Product(399165290221, 798330580441),
        Product(60807114061, 121614228121),
        Product(286600958341, 573201916681),
        Product(399165290221, 798330580441),
        Product(1223875355821, 2447750711641),
        Product(577770158461, 1155540316921),
        Product(1287836182261, 2575672364521),
        Product(1247050339261, 2494100678521),
        Product(525703281661, 1051406563321),
        Product(424665351661, 849330703321),
        Product(60807114061, 121614228121),
        Product(1304747157001, 2609494314001),
        Product(286600958341, 573201916681),
    ]),
    # Some primality tests use only 3 bases for a Miller-Rabin test of a large
    # integer. Hence a Carmichael number passes such tests with probability
    # 1/64 in the worst case. The list below contains such worst cases and
    # should catch such faulty tests.
    ("Carmichael number with 3 prime factors", None, [
        small_number_of_mr_tests
    ], [
        Product(
            10304107190381179132130093481782833960306185542397091086921143803667477316678055417247841876241793814552513723150566155565622619770134291954927999343931313292529969270078509975431831858133256115091758989699244791,
            17173511983968631886883489136304723267176975903995151811535239672779128861130092362079736460402989690920856205250943592609371032950223819924879998906552188820883282116797516625719719763555426858486264982832074651,
            58389940745493348415403863063436059108401718073583516159219814887449038127842314031071103965370164949130911097853208214871861512030760987744591996282277441991003159197111556527447047196088451318853300941629053811
        ),
        Product(
            13494851928618441384172186492325164239092576105577322146584402625794978868933932973127017829148222452878645732968615545551719217604467790835812481909646113774892380792129960444853070838692105111213484558721817513,
            22491419881030735640286977487208607065154293509295536910974004376324964781556554955211696381913704088131076221614359242586198696007446318059687469849410189624820634653549934074755118064486841852022474264536362521,
            85467395547916795433090514451392706847586315335323040261701216630034866169914908829804446251272075534898089642134565121827555044828296008626812385427758720574318411683489749484069448645049999037685402205238177577
        ),
        Product(
            12314139989794550409077039429870339696613306330919909607533266729938923532005482246330995482609396735372304543858044193643556573370390444148364543204557881544720167863101834875338263325685638714262478283376036539,
            20523566649657584015128399049783899494355510551533182679222111216564872553342470410551659137682327892287174239763406989405927622283984073580607572007596469241200279771836391458897105542809397857104130472293394231,
            299644073085000726620874626126844932617590454052384467116642823761847139278800067994054223410161987227392743900545742045326543285346167474276870551310908450921524084668811315299897740925017208713720304895483555759
        ),
        Product(
            12683089788355596722066003134387681759974667112022236228734289560678591043633242390882935183583460873345582687226397693047545828306221341064063916953556581406255471295948280695297572605716430197433693588023639691,
            21138482980592661203443338557312802933291111853370393714557149267797651739388737318138225305972434788909304478710662821745909713843702235106773194922594302343759118826580467825495954342860716995722822646706066151,
            536917467707053594567460799355745194505594241075608000349751591402060354180473927880710922771699843638296333759250835672346106731630036771712039151033895279531481618195143882767597240308662211691359695226334080211
        ),
        Product(
            4193581638662969629581054177485124366088928423823109423578509113771166870962430424675647628391264774115187129672497118873557566997637246503469697914099497885577729133892970114669229552853915871560020137734652553,
            6989302731104949382635090295808540610148214039705182372630848522951944784937384041126079380652107956858645216120828531455929278329395410839116163190165829809296215223154950191115382588089859785933366896224420921,
            250217037773557187898336232589945753843306062621445528940184377121679623300758348672313641827345464855539498737125661426122268164192355708040358642207936707172804504988947216841930696653616980336414534884834268937
        ),
        Product(
            6375358100663067312168740390571493462527007897358845824311159877360231940491065271082308527148600808263294209410556531551196951319862432915666779735219485556881848745850386867588834933363984876834888597739353467,
            10625596834438445520281233984285822437545013162264743040518599795600386567485108785137180878581001347105490349017594219251994918866437388192777966225365809261469747909750644779314724888939974794724814329565589111,
            533404961088809965118117946011148286364759660745690100634033709739139405687752461013886480104766267624695615520683229806450144927095156887277453904513363624925781345069482367921599189424786734695185679344192573323
        ),
        Product(
            14481009144831289875514608091205696722295919995814013980645039488992795423927421632008247509207474852530919692260514544006640314363743715634844968667020949133959508306023771681732498586686631238475041955105983501,
            24135015241385483125857680152009494537159866659690023301075065814987992373212369386680412515345791420884866153767524240011067190606239526058074947778368248556599180510039619469554164311144385397458403258509972501,
            4812522039132265335296021422310693210709677411942190646234368123508605679218546455704074255559950809324442311061244333458206797806884161495980144587006628762185876593701900122229100363642190448253205609746888516501
        ),
        Product(
            6731560752433669992970657026290132378109618991733898386931537382203688618831793396684083403903135180873643356037440199824324917654951352826112393924381369584593593694641081306183312396828955528708603810010569851,
            38145510930457463293500389815644083475954507619825424192612045165820902173380162581209805955451099358283979017545494465671174533378057666014636898904827760979363697602966127401705436915364081329348754923393229151,
            42633218098746576622147494499837505061360920280981356450566403420623361252601358178999194891386522812199741254903787932220724478481358567898711828187748674035759426732726848272494311846583385015154490796733609051
        ),
        Product(
            15157118621778068063394584335594995274645817750027390265526421681972396914756746918854959556317210635190347247072251891045767512819599124239733555010688811458556841513978542002067655212508438600430228158027834323,
            85890338856742385692569311235038306556326300583488544837983056197843582516954899206844770819130860266078634400076094049259349239311061704025156811727236598265155435245878404678383379537547818735771292895491061159,
            368823219796599656209268218832811551683048231917333163127809594261328324925747508358804015870385458789631783012091462682113676145276912023166849838593427745491549810173477855383646276837705339277135551845343968503
        ),
        Product(
            15575429198322632064709392823645541257967241808087053873858181443623388862930006624240700121758409398087162653572339213541806261493023174192686222107788318996499993472201184943225686826605377696183430861719963803,
            88260765457161581700019892667324733795147703579159971951863028180532536889936704204030634023297653255827255036909922210070235481793797987091888591944133807646833296342473381344945558684097140278372774883079794879,
            659359836062324757406030962867661246587279903209018613993329681113390128530703613759522971821105997852356552334562360039936465069871314374157050069229705504185166390323183495929887408992960989138431906479478467619
        ),
        Product(
            2523675732556245979259271775531059488931120873395412946065792693789356927779350246335299066950657422396709751241497799038927224465510268232338132241651347789707001014364034602548086294043070198704587882289889213,
            14300829151152060549135873394676003770609684949240673361039491931473022590749651395900028046053725393581355257035154194553920938637891519983249416036024304141673005748062862747772488999577397792659331332976038869,
            150579318709189343429136549273353216172890212112592972448592297396098296690834564698006177661389226203003681824076035342655991059775446004529508557085197084785851060523720731285369148877903188522707076976630056317
        ),
        Product(
            3333658016919018518493284378611144490166147710477412787904199508885833397776071396272859950887551824656078920412433577438295011598123792769886075326879384408308490659111210040189439960334485538106486818156686761,
            18890728762541104938128611478796485444274837026038672464790463883686389254064404578879539721696127006384447215670456938817005065722701492362687760185649844980414780401630190227740159775228751382603425302887891641,
            278916054082224549380604793010465755677234358443276869921318025576781394280597973488162615890925169329558603007840275979004015970376357328413801635682241828828477051812304573362516476681318623354909397119109458921
        ),
        Product(
            15432168551889611738559903469578212936248891116148938289087821368501212196703740299304218525370717023195047308850285791287586035566116219558219193902807509567068427259149646820056706360019307471070573954777178009,
            87448955127374466518506119660943206638743716324843983638164321088173535781321195029390571643767396464771934750151619483962987534874658577496575432115909220880054421135181331980321336040109409002733252410404008713,
            5128624015411314301114741253056492765813381480933497158073519301465236186704543026135435289931534957375154055641244977971241092486472623633181512107033029012789073992457399293198845413646416516219120744304282157993
        ),
        Product(
            9688803015487940272326337800443135590391434656119429897258563776066083628899863189540955135713594918482799868033360701192601241298831658198487023795068887508606065792449475650904624068765886481118974554392303971,
            61362419098090288391400139402806525405812419488756389349304237248418529649699133533759382526186101150391065830877951107553141194892600501923751150702102954221171750018846679122395952435517281047086838844484591811,
            235760873376873213293274219810782966032858243298906127499958385217608034969896670945496574969030809683081463455478443729019963538271570349496517579013342929376080934282937240838679185673303237707228380823546063271
        ),
        Product(
            1302899948139262550517519785908924832418681070326239295795209939295689916420522672413450542135600631543250815948224548082983171663477161211890377858741508312653406021085322373153123680441144000088730709890749833,
            8251699671548662819944291977423190605318313445399515540036329615539369470663310258618520100192137333107255167672088804525560087202022021008639059772029552646804904800207041696636449976127245333895294495974748937,
            55156097804562114638575004270144484572390831977144130188663887430184206461802126465502739617073760068664284541808172535512954267087199824636692662686723851902327521559278647130148902472008429337089600052041742889
        ),
        Product(
            772113121608098145894431394676338252184807317738043333689115003642511587605902644032219573760763348631611096935948121669454679247671747920146988911856273161335204684324519101546060466616767137425999372124006247,
            4890049770184621590664732166283475597170446345674274446697728356402573388170716745537390633818167874666870280594338103906546301901921070160930929775089730021789629667388620976458382955239525203697996023452039559,
            46069416255949856038367739882354849047026836625036585576783861884003191393818857760589101234392213135019462117178237926277462528444414292568770338407424298626333879498029639725581607841467105866417962536732372679
        ),
        Product(
            3164086471219907260489091853677201652369277422356042661805300860533473476803418822061999492435397074765914284223584443031535377102937000759802254923614468828436046767759837358279086351117438714902116246427160767,
            20039214317726079316430915073288943798338757008254936858100238783378665353088319206392663452090848140184123800082701472533057388318601004812080947849558302580094962862478969935767546890410445194380069560705351519,
            264728568092065574127587351757659204914896211003788902704376838664633947559219374779187290867094888588748161780039898400305126550945729063570121995275743891979149246235906392309350224710159039146810392617739117423
        ),
        Product(
            8892444071617005327638761592140496859087006139122718765816929940446314815796061477562911259131006532019951252908868078139683350837339349699337191409726123415458592445686762409371952183027768150056299519826737961,
            56318812453574367075045490083556480107551038881110552183507222956159993833375056024565104641163041369459691268422831161551327888636482548095802212261598781631237752156016161926022363825842531617023230292236007081,
            2955255579800718103885281769121358456169915040235116869839826383541658623782891097710074175117871170807963799716713824635088100261609110550079726611832315015070738889449900707381278775492894948535376873755752582041
        ),
        Product(
            6416924503328748684361537517910027155041537467195927986740106623630494080111410667824669140537552382549811947292055602939421778654730388216047233091218207963298347932037385628792506731522959968952723901880564071,
            156145162914332884652797412935810660772677411701767581010675927841675355949377659583733615753080441308712090717440019671525929947265106113257149338552976393773593133012909716967284330467058692577849614945760392371,
            271649803974250360971305088258191149563425086111294284771997847067024249391383051604577660282756384194608705768697020524435521963050253101145999534194904137112963395789582658285549451634471972018998645179610545631
        ),
        Product(
            7573211124494598660087030355812057299381355235612169757890817084689895318177544166514343980124404570867132573461885095625082154818252063167225060058814043426825890423105644688536369517444253257179241393549630501,
            184281470696035234062117738658093394284946310733229464108676549060787452742320241385182370183027177891100225954239203993543665767244133537069143128097808390052763333628904020754384991591143495924694873909707675501,
            451868263761511053385192811230119418863087529058192795554152086053163753984593468602022524147422806061738910216559144038963235237489039768977761916842571257800611461911970133082670047874173777678361403148461286501
        ),
        Product(
            7810692055968453746621833614343201169379968350796462651975184743750790772466663738611998071064441249608603861854918334939825092221574776919282190182903068235542439968186621198768176619558597530421367784167595977,
            190060173361899041167797951282351228454912563202713924531396162097935908796688817639558619729234737073809360638469679483535743910724986238369199961117307993731532705892541115836692297742592539906919949414744835417,
            653494568682693963467360079066714497838124018683304041881923790227149494629710866130537171945724917883919856441861500689965366049205089668913276578636223375707050810671613973630270777169735993378587771275355529993
        ),
        Product(
            7561403778539633225855384372432682691114915080070177511324303263041875272388035270465842480888711779106688901799741605077682008437663855268598581956089812180391535915404128338909609993969148374934644585362836573,
            183994158611131075162481019729195278817129600281707652775558046067352298294775524914668833701625319958262763277127045723556928871983153811535898827598185429722860707274833789580133843186582610456743018243829023253,
            2512906522401338108725939406438461547680523444943322326263443451084249882190290388218148317815348547923122945031447460087482987470783621234264262070073847581283453769219305317964293721329080309936613550535582687429
        ),
        Product(
            29657785103613978507479490825623815814695327186086296979211588145938868927283126013155333425120239928836955298228610264566581474960413128155448332263464670626808379687466173786097533408440953987788873054928901,
            1255512902719658423483298444951408202822102184210986572119957231511412117921652334556909114996756823654097774291677834533318615773324155758580646065820004389868221406769401356944795580957333718816395625991990101,
            1769581177848967384279609619262221010276821188769815719759624759374352512661226518784934894365507649087271666127640412452472694672637983313275083825053392014066233321352148369237152826703643587938069425610757701
        ),
        Product(
            11473739491266348269374870950903394303033537226868957468411330733168493174820646415177565478963668907164993219123076467526244454352463889888427326464648613057989174883523411393901770255007305187650337333479915759,
            485721638463608743403536203588243692161753075937452532829413001037466211067407364909183605276128650403318046276210237125277681900920971338610090153670124619454875070069157749008508274128642586277197613783983100423,
            959969537435951138537697536225583990020472614648036108190414671341763928959994083403189645073293631899471099333297397783029119347489478787331752980875600625851760965254792086623114778002277867366744890234486285087
        ),
        Product(
            13784206406631798116949453444145033016050125919841746022077999568077753050238176643454021265490748595576025146894413406529864656936247199619472530756071886524519180148878306433591217234882779231391012155957779509,
            583531404547412786950860195802139731012788663939967248267968648381958212460082811239553566905775023879385064551863500876430937143634464783891003802007043196204645292969181639022028196276704320795552847935545999173,
            4580951262470634240866201694604199305667325180694073594670588523124506597029154037841219733898092116596432357151243388770091687655146152673538037721267890288315207536143890504763481194392710297898946373163302056493
        ),
        Product(
            4717458511749169044906297359025857619442937803351800644251539794891664590565284423990163233434678081232945873899534112375959897423198775206688638653708289846928157327988188628037011783457715201505105407220774351,
            281475024534367086346075742421876171293428622266657438440341874428535987237061970631413072928269125513565770476005535371765607212917526920665755439671261294200046720569961921472875036412977007023137955964172869551,
            394694028816347143423826879038496754160059129547100653902378829505935937410628796807176990530701399463156471449594354068788644751074297525626282767360260250526322496441678448545763319215962171859260485737471453951
        ),
        Product(
            4627173609043877060440478523610370363186897736299991760145650981805412033188260245084747053213908380091404672331568740421494395916810758463166706664950389764693557853074437195230528841149257586861541806417348471,
            276088025339617997939615218575418765003484898265899508355357175247722917980232861290056574175096533345453812115783601511815832289703041921635613497675373255960048951900108085982088220855239036016071994449568458711,
            1537764029405581809753052362679846417365779014363697261621738009619998599029565154783164270684755551650376819438191344733409970909686775395925735514985179531799825726505071294548279084875269938033652393666032141531
        ),
        Product(
            2528990538648542903793448004895013298104370605200942772701265567961350516391869554123055765979165705256728497443188737260351786193772124153660034224063057069665651636744493111824183433084132135031465512603351769,
            211592208400261422950718483076216112608065673968478878649339219186099659871453086028295665753590197339812950952746791017449432778212267720856222863413275774828692853607622590355956680568039055297632614554480431257,
            840467855677532425027355886960109419403352497795113314794387257085822154947564648486895532893742736046986103983619723682856910278396935927066351373796955966152218227278086544162903627594959912875457038688513904233
        ),
        Product(
            2374976588877107687162314256586430276273830268649778258423353121095971291596666518881472783418775306897613229004622477231264832234959705223644703748675373476880642798124407258234351417934141180873548243814026491,
            8074920402182166136351868472393862939331022913409246078639400611726302391428666164197007463623836043451884978615716422586300429598862997760391992745496269821394185513622984677996794820976080014970064028967690067,
            9024911037733009211216794175028435049840555020869157382008741860164690908067332771749596576991346166210930270217565413478806362492846879849849874244966419212146442632872747581290535388149736487319483326493300663
        ),
        Product(
            15455737884653467961678679129580220641096766923128898018218833673752183421806606181764919458764378595712594072514072187491988186057203436719246992570578992895251254703452254918505408759539054680510402772339081851,
            52549508807821791069707509040572750179729007538638253261944034490757423634142461018000726159798887225422819846547845437472759832594491684845439774739968575843854265991737666722918389782432785913735369425952878291,
            225653773115940632240508715291871221360012797077681911065994971636781877958376450253767824097959927497403873458705453937383027516435170176101006091530453296270668318670402921810178967889270198335451880476150595011
        ),
        Product(
            24223301392278522904389482377028257571573884638362492315547021641782263688676454755789797470505434795208147766723527479717624272183775929163597132116256988542473900517340130604536406764151562032356780423460184321,
            82359224733746977874924240081896075743351207770432473872859873582059696541499946169685311399718478303707702406859993431039922525424838159156230249195273761044411261758956444055423782998115310910013053439764626689,
            615271855363874481771492852376517742317976669814407304814894349701269497692381950797060855750838043798286953274777597984827656513467908600755367155752927508978837073140439317355224731809449675621862222755888681729
        ),
        Product(
            13517643548261779225455890728278475912580552335819354786603804117659623534075769924856593160919141811383245033024222239938603594633593919639453017848896013071429215882372922861041226400807120880040548172493737791,
            45959988064090049366550028476146818102773877941785806274452934000042720015857617744512416747125082158703033112282355615791252221754219326774140260686246444442859334000067937727540169762744210992137863786478708487,
            483931639027771696271320888072369437670383773622332901360416187412214522519912563309866035160905276847520172182267156189802008687882662323092418038990477267957165928588950638425275905148894927505451624575275812883
        ),
        Product(
            7084947987127155066626838275672820477625040125838700987721040904245991170143392409967105360843665854252032304588674801019124230167092193502701969006883061750489547894769689286468356037810875816481635684332647731,
            24088823156232327226531250137287589623925136427851583358251539074436369978487534193888158226868463904456909835601494323465022382568113457909186694623402409951664462842216943573992410528556977776037561326731002283,
            355664388953783184344667281438775587976777014317102789583596253393148756741198298980348689114352025883452021690351475011160036354388028113835638844145529699874575304317438402180711473098105965987378111353498916047
        ),
        Product(
            13946058721225101988528140084847310749402400902825618726277076519161448095761155705326588595436677586348190799948912874628720988732023316971951493634204756233418406987504374503704711033597293580554170847696843321,
            47416599652165346760995676288480856547968163069607103669342060165148923525587929398110401224484703793583848719826303773737651361688879277704635078356296171193622583757514873312596017514230798173884180882169267289,
            2780844109012285336512511132918553763430838740023428374019649057920792750294774447642121765930073510717829245509813227200966965153165449404207127830660428392943630353308372276038719380099300339962501667030750558009
        ),
        Product(
            18257159426738938097832613093759370658358804159500302329938387313501409621421863459254842536608852126109148972896812976593031365595380681418666816448343146588844968168133089220573979550941283197133627256037765521,
            69377205821607964771763929756285608501763455806101148853765871791305356561403081145168401639113638079214766097007889311053519189262446589390933902503703957037610879038905739038181122293576876149107783572943508977,
            266554527630388496228356151168886811612038540728704414017100454777120580472759206505120701034489241041193575004293469458258257937692557948712535520145809940197136535254743102620380101443742734678150957938151376593
        ),
        Product(
            20686139602016441597820639599952428909765181137075526971717911990102162480687434499386285370119111532880324436090919930770581783428053624386201262503405854067888418247781404850308935088102360797823297671103215091,
            78607330487662478071718430479819229857107688320887002492528065562388217426612251097667884406452623824945232857145495736928210777026603772667564797512942245457975989341569338431173953334788971031728531150192217343,
            525427945891217616584644245838791694308035600881718385081634964548594927009460836284411648401025432935160240676709366241572777299072562059409512067586508693324365823493647683197846951237799964264711760846021663287
        ),
        Product(
            5500911902580579929239433043505063803386561596395407125087709805790462427828930560284585203821379633428944688406172417120012789336082640785026401098802679769405641106207926186764489350786910370379989070693335211,
            20903465229806203731109845565319242452868934066302547075333297262003757225749936129081423774521242607029989815943455185056048599477114034983100324175450183123741436203590119509705059532990259407443958468634673799,
            196932646112384761466771702957481284161238905150955575078140011047298554916275714058188150296805390876756219844940972532896457858231758540103945159337135935744721951602243757486168718758171391259603608730821400519
        ),
        Product(
            7726892883245941241023011736283710169555904370688262877833077160915617845302016212841042729167718846807666910528530852803509155519106085094311393719812464740627954591417282604123430833582799844434812375936363601,
            29362192956334576715887444597878098644312436608615398935765693211479347812147661608795962370837331617869134260008417240653334790972603123358383296135287366014386227447385673895669037167614639408852287028558181681,
            387890022738946250299355189161442250511706399408550796467220473477964015834161213884620345004219486109744878908532248810736159607059125471734431964734585729979523320489147586726996227845856552190627581272005452721
        ),
        Product(
            6115797732435476935882162680605159367826079466108464763502585715318641057240649396847350024716479776276383666734698754316507988005140421925804920906799121223387076540461940053301522389201822920278048124046854391,
            23240031383254812356352218186299605597739101971212166101309825718210836017514467708019930093922623149850257933591855266402730354419533603318058699445836660648870890853755372202545785078966927097056582871378046683,
            1219490067847634101014903238512668777944520245542027873842415591634537026813785489731361594928466067389510903146898931610711692808225000132005501228815744771943383062168110846628323564406843490303442795934942765367
        ),
        Product(
            19486133408424889342990503592554823438918869822092758228161275571998092077703484268677009487462729307339829760012408774911726288735196250353059037235578712978112307686582722729244966860809674297403021483248868751,
            284497547763003384407661352451300422208215499402554270131154623351172144334470870322684338516955847887161514496181168113711203815533865255154661943639449209480439692224107751846976516167821244742084113655433483751,
            494947788573992189311958791250892515348539293481156058995296399528751538773668500424396040981553324406431675904315182882757847733873984758967699545783699309644052615239201157322822158264565727154036745674521266251
        ),
        Product(
            16076203159247894438582929777403669089617759113061214602713781936859390049462903589512603191930707343959780065427102062996985936736964136084436445281202988495295726470501816709690277315202334265733646205253289621,
            234712566125019258803310774750093568708419283050693733199621216278147094722158392406884006602188327221812788955235690119755994676359676386832772101105563632031317606469326523961478048801954080279711234596698028453,
            575528073101074620901268886031051353408315776247591482777153393339566163770771948504551194271119322913760126342290253855292096535183316071822824741067066988131587007643965038206911927884243566713264534148067768397
        ),
        Product(
            16423766949682209078383860536189123978330854124362980281163578764412741465095656457899570401431198637946788874495203218968709910583502433990253600486988924692093449183391524121544096810599290851743897344605738611,
            239786997465360252544404363828361210083630470215699512104988249960426025390396584285333727860895500114023117567629966996943164694519135536257702567110038300504564358077516252174543813434749646435460901231243783707,
            824473100874046895734869798916694023712208877043021610114411653973519621547801954186558434151846171624928801499659201592229237511291822186310730744446844019543091149006254510901513659892084400757543646699208078223
        ),
        Product(
            15480544129792756498698423551274518396843414273376549632931136805949789913515699137065703830462863958349495700721632578201446323653999711539409622275174103861321515378521671340255375120718639936529932227788739501,
            226015944294974244880996983848607968593913848391297624640794597366866932737329207401159275924757813791902637230535835641741116325348395788475380485217541916375294124526416401567728476762492143073337010525715596701,
            3086820499480675645840465656124138968330576806111283996806468679106388108755030407930901343794295073294889442723893536093368396936607542480958278681669716309947510166477221265246921799071296803344068486221074656301
        ),
        Product(
            9308726401999333628449925927601340813063994298776996460343490423887971684183318702885164197679766880391964196856202923680464153710406492562825849746170904974988925349759066403158740916812093473684129882221879941,
            236441650610783074162628118561074056651825455188935710092724656766754480778256295053283170621066078761955890600147554261483789504244324911095776583552740986364718703883880286640232019287027174231576899008435750477,
            333252405191576143898507348208128001107690995896216473280296957175189386293762809563288878276935654318032318247452064667760616702832552433749165420912918398104603527521374577233082924821872946357891849783543301853
        ),
        Product(
            7305180427682323290862014500353187576778326597718648878898380393139292567926909215685302130779928521214241047334112308751889435504513272291732098944354327273941292328146466740343638757519179457592622371111790331,
            185551582863131011587895168308970964450169495582053681524018861985738031225343494078406674121810184438841722602286452642297991661814637116209995313186599912758108825134920255204728424440987158222852608226239474383,
            366720057469652629201273127917730016354271995205476173720698695735592486909930842627402166965152411764954900576172437899344849662326566269044951367006587229151852874872952630365250665627462808771149643029811874567
        ),
        Product(
            24074374880118062760120915012096970192168372419608189045775289488682469806074334688900851684708110396517013150078516585416238292085521735602445380393881850444514975113431632347786539423515319333570570142653590271,
            611489121954998794107071241307263042881076659458048001762692353012534733074288101098081632791586004071532134011994321269572452618972252084302112662004599001290680367881163461633778101357289111072692481623401192859,
            4800430351095541714368110453412135856318373460469872895727592724043284479331222336966829825930797213065492422125656207131997915441853034079127608850540040978636286037618267490148635961048954675113971686445125899839
        ),
        Product(
            18589769062276451323453648037135198465755727115433144002915631151011446079809047541291378391591198548346419182511909597721192941403577225988305409407581399676281483611182007037683785524561367565562733821600487401,
            665513732429496957379640599729440105074055030732506555304379595206209769657163901978231346418964908030801806733926363598418707302248064690381333656791414108410877113280315851949079521779296958847145870813297448921,
            933206406926277856437373131464186962980937501194743828946364683780774593206414186572827195257878167126990242962097861805603885658459576744612931552260586263749330477281336753291726033332980651791249237844344467481
        ),
        Product(
            12621825825388783074294631109413446617832081512493798608129167840801182182704776416506400594511266019253073842481323299182352271110148574512748477701647146086769261242029368527113007282202877395133541775277914641,
            451861364548918434059747793717001388918388518147277990171024208700682322140830995710929141283503323489260043560831374110728211305743318967556395501718967829906339552464651393270645660702863010745780795554949344113,
            2516792069582523345014349443217041255595717053591263442460956067455755727231332417451376278545546444239062924190775865856961042859363625757842046453708440929701790691660656084306333652071253752589628229990416179217
        ),
        Product(
            9673142059502290763893932606816967984295394531096662252866920653102887601565313376951015820217683836270439941246880756549376347750485191662245660577633722422693833230904223847826847466004803819816722445720587381,
            485591731387014996347475416862211792811628805461052445093919416785764957598578731522940994174927728580776085050593413978778692657074356621444732160997212865619230428191392037160907742793441151754799466775173486477,
            1928824526664756778320450161799303416068501669500674453221663978228715787752123487364032554551406156952325724284628022855945643741446747217451784719180164251085150346242302235256673384721357881671454455676685123573
        ),
        Product(
            28899182991468430475260868075508798191123275068872069597392768213852016435003090013026745375054175162585541226560757163862868357254371049503529720340581524046114316478586720439044662123830877294378963778253659641,
            32299086872817657589997440790274539154784836841680548373556623297834606603826982955735774242707607534654428429685552124317323458107826467092180275674767585698598353711361628725991092961928627564305900693342325481,
            124096491669246789687884904088949545173647004707509475329980710565364541162072092408879553669350281580514382914055016056587611181151122741985745269697791250315667358996284152473544725590567884852333197400736303161
        ),
        Product(
            2924897107510402910047686068226956161172697174619641365743141473070093697280593408544592166240918726402222286641765210899425778141487430277950675720637979916400916429825142698283602048445671668292970601014970369,
            3269002649570450311229766782136009827193014489280775644065863999313634132254780868373367715210438576567189614481972882769946457922838892663591931687771859906565730127451630074552261112968691864562731848193202177,
            21850701920813009975062125333224907792290149480982026673492880416464817620860903699127247359564510485475425317853187163778063166115817861488219753913001379375465669799281948393059850597211782463129839195817719809
        ),
        Product(
            39581441999153519661452462118283345146542979768588046408228142761712249736652471900227177540896947752344392752185239136680795539361041311492390129848724026255590078640423731848191009123540899412883044689552706459,
            44238082234348051386329222367493150457900977388421934220960865439560749705670409770842139604531882782031968370089384917466771485168222642256200733360338617579777146715767700300919363138075122873222226417735377807,
            416769301049910589376470042304277575366540786975132959239578679667440747227105439420039104695326685157038017802421047380344847149742729103361049014289505923514742592743285176519187684300812999700356764672349085647
        ),
        Product(
            48395402083804841655676511994819673930439975557758548153606278531221574184910156904549063049704970510110241974766545438452754960580721562897626616330314668764698774241944711490212741903109673698597780684893707167,
            54088978799546587732814925170680812039903502093965436171677605417247641736076057716848952820258496452476152795327315490035432014766688805591465041780939923913486865329232324606708358597593164721962225471351790363,
            714543877825589132680870853570572832737672580293964446267951524196271477671320551943636166204467505766921807980376641473625970300338888958076722394053469521172905431454595446120199895157678123432237820700489441099
        ),
        Product(
            36295447596715016282961758376884494505184784482282397159244060228101965026668972490122725257037143863171435313221497250179520963928112562412920428213519364571043943194620175682691055087092237342331264123810963979,
            40565500255152077022133729950635611505794759127256796825037479078466902088630028077195987051982690200015133585365202809024170489096125805049734596238639289814696171805751961057125296862044265264958471667788724447,
            2128621250230874778477227829514931824804072360519738233398019296906921125387586210156021004780354848916583588663637221084057788296254601454451862760522282733960635962649195009155469524813585919429662960672913593299
        ),
        Product(
            56960926848499093906023641390377004224609617307235585532076412429142825294053230434531093533357610193268347740857729340501350219974233790524715356995205119151630759254691493023484785025521252155870204322558769081,
            244596921172966697361160342441030665199794239025188102578916359254554485086228577748280578113829737888740552063683190697446974474007003924017895356508821982239355613270145822983199370991944200434030877385105302521,
            425531629985846172121470732739875266854436552824642315445512022264772871314397662657967581102142146737945891946407742720215969290395746552743461784611238243073947436785048212587209864602423471987971526409703745481
        ),
        Product(
            18883252441481023263175513334227357353453906956685813215014986199098227342350419905495818103170227875622066638155878779205209574051030616605504009640461072990879160268621532653634807461753333431362848079126803461,
            81086907542830276365400733729329240400125600461062609688005528972598270352445920770658513031260390289435933210904655934234135229748543236011870159044332842843186982329963051983255349688705490617028700575073920741,
            198829540413241362594612758048629233309897020308632974440451913508151923192983833122573614145145340572726466366464841263396030220890263551316777513273090121492198216946073785000037090332579216718467635656688107021
        ),
        Product(
            56609405451413117462124712483911224179812370954182118033390848070181745564944127886289901001066990525654401746284770350611692463749568168102701635660840729093469245398991598759754028981436921197308733945520281323,
            243087446938421033807947294783854080301547239979723212731619524066074554484760078570538986651640606374868901616399307976156091167865792721852777611955374895519014994948610982909532006802640896906090445766057678619,
            835821221664981910764311931380101015831347359382335978022417815624448125694175064674045008898106742467014990489263374000207929905949506481986947679463001353085928270302758311099897722020039248266146601195622977167
        ),
        Product(
            9028906307393147535409220732498920639502530698007086755333428520260062407685610198509619771353891339139068457653481634630808839406564689279965913716844692811318982891967031372862503958086477818665398005442348683,
            38771185908217633534404300792495365099040278879677490184667075410528503280061737911247190782872592221008941024041421136944061486863483665731618335372333092660369750065505487659938987584724287103680826729252438459,
            529518799321821652517823121782436698681413123877239146768672249099957777674267845171417112472931156771861838369442422925112730169902646777183883292687891690169707408428890016396700967424248140306435400672118919763
        ),
        Product(
            59435348332803184866382323501827560949740565531609899313078127741378608021837392953558982220594888221985435712602966644617772234720271902346074265869027042459685337256636738110560125485608239300843351545944369239,
            444017014015647322237091475572476484742179518971438659574171895479710777574902876770705337765620635540714725617680986109791592577027913623408907750903907905434119872446639161178890349216014493600417979196172640779,
            625819255974810005357790347460419612353150660597539528061234403865104166818170196393356342205087352455023117209172413493328307647936980618820429034738578858840216198172822124811191909524933813814762348630826005507
        ),
        Product(
            77500584367622908047512279584873561418825330000811820056490593022432268085421909669266254254148763076100205484589672208143238469508055770898177854113443703691057062689688253606615366086963575618508907855424264967,
            578974953805182901296121147486996605893577465300182420422017959638170473344034266352753781780993700627336829208405198260834781507501357817886387498376902962868485115387671071061185381943786711973566546919934214747,
            1144273333898432348230916598576662583301479872364927460834066991095911722908288195705048812811255266594185386860706336720232520932148352852673096551910257036850313102065397156191791581636932792955631521865381794499
        ),
        Product(
            18383782650563719810480431128347761183802024323237738965907958270469473092189482093742006689933525827870463246582414015918474136755768558213274628033531663828753645567872247850231369443987643139354178770261235129,
            137337670389505436231236161958833274726050417003011344039430041197036651924003777994425579389503398831738166606821563530685071492234270993710933985897560076838336058065869145704669642316848863452822394342539815369,
            1078154782506589920649940578527218700014742250015766220530013787979886157230171391027104745286101485316873638637803927874748159667382426619919694361731239343368669684186390065098863255038569424113889190232379495449
        ),
        Product(
            88482921972851593669391570771610285689849016332885565348771250914908937624076141054769525798537851424738302519262800639526344646181593306953878808612902317380217444508772282000113955279591844104395757227740427401,
            931673119596496192165946539301073008146057289622736246907650230221688225571154661694337948114016200295773891232237724380895040686265011879102606278924089106532877798062955204589435176179231770275696502574443323801,
            1306424318540338235942193191980834218126594299973780994267151998802479020214300670867479469143117688682900819549115468265947794481857642355613151821284616568378504621864814281295800163245738404129607944950755722201
        ),
        Product(
            32076531914956590706068545510473602392663334853024349755385259012956665518151555785190925730625824033942814957879609699570047398788062204800050600220089192606053938768355237855253604343595752021917707654679978371,
            337747012516307631552133508610280872252160996393609329777291844901131948691125205032304453281295441298574345732967655071943440257827243215247591614082115616263744414090328680946493833970802330113133510011042125191,
            1881194254071277701997078816114245975616784991086192747418770778583399736564535359872667820790232150696528618412115933557137485681864589305038261671731113236955045703061774831863990795915586162697173795983290496171
        ),
        Product(
            55945606347442309829689146494194254990227502945615304484841903143374586226020407316501022896571020751735920872374993659413606899826813362435827696670559374667291671856004495342856477013180859660821689266815428493,
            826020423129883515720704457061338706032182543491143613276195158175707126043007190378926867472901541687395066998007259324283254815090009057140750109665317825970012331521007548885704454724023280874484941527686620677,
            3281045266376469582364710532630098366191577672751674033611022201996733086314255652620677636934194569969453712338698157555021534066313701314618836092973393914311164520025675403342818093067136298931719070530293070973
        ),
        Product(
            18531410332926063590709524660123435245530068613814154830353157792823685983809318854147142448938324649080989368103600661538522903389406018026818748176688342384506115390995283354963268013417736109411892626324761171,
            71199629173873823269568173694158461732826053095180700137672658888217319832530540860670599935394615756995380203766465699595377470917191542945145716678855210214155074923297667626964134998920775578266745353774082391,
            123867848014821582948426822728193488220122037576547245444992159983610953681251762867194057421850906864909771039429330737652232038444977067863472685181022078043804034455600051898965001984423815047121598081223403611
        ),
        Product(
            8101023757611592401710090265936168594058587438843109281346697052084355243684078157638530021630060219540792559106070761297907450592618841958111099117781438538707461116708101445516361108786294664018031469734746249,
            31124986016086644490780873127017910914014572791344577765174151831692522778365142395137510083104968211919887200775956082881433889119009234891690012399897105964507613764194284501194440049547342656490331436349288217,
            76320171190130265258216113558030219912446692186995608492687303806478925716813157379857730203777935752515887793683508751175022824004145932131678249583309342022559765257407903091969928340670881308380401741185240969
        ),
        Product(
            58560853255991946051072898341685221560458793799127412837622695945595656733566076092697415839727135092669111852018536090627715397912509618664494948524366336505316344832085202474090101154904737158034854717431413739,
            224996962509863792722543240997001114416499576175594796691918779159393839028964397619311124015793729566570798168281743927148590739348063271710954275909407503415162798565379988453083020226739253291397073388025958047,
            773619693013367287306278814934894242719745118083209506433857720123395254743425531540371125040605837276839319729297503091976661309265258646567801688400839498043915923834388727420874494204267843508776238635541307803
        ),
        Product(
            96444183592696292189817345174090426238177078188469838757514091812923602851854794956865519356839307060341672373747898714597421747721439823918240444947710084375660574400541755148070205585405575852396469134406968131,
            370548705382464701571403484089926374494048774092542012068343615912811737272915791150062258581540495547628530699136663482400620399140268797159555393746465061022274838486292006621532895143926686169733802463774140711,
            5060781633785168595434099638872008155761186681784443644275871028288675370699959503789206463093094165218981439822455527287033130656751342339288722295414050216975452246175796309611894472034176796044172617210723538191
        ),
        Product(
            14667167043335042779839691803021417036496276633212973816853732755798895019198189958894022306462086359906541251592346427831321907566285212747851562345346209062772170491384913352644529648606288330934205050983314057,
            98038432342292128054717939946511577033422480653581456565285476841392614075693164462081096469509735142533196786959368228135678013732538000998797285150472028998529771179257052409781856072263085159402317972362151849,
            138180152671419613557437096460043876291201764070795911221937798067789589917709263296948946992458603074908993896580526872726664287071844899045548929464051127486116764103047341585440568794764505854590668638211221897
        ),
        Product(
            11970347321201152313621121978555694718810923003017958102127834196778961823344523434078013140304536060648377175459418345470353104410728161033092958845783503711343585645150022733330932269122578061790129490861555793,
            80012321568028754938414867961924906804683537967541088366854470683733060608671288217258298358877688405386521120176112098670254961061182971115937145969184472175822914575476467743843599904135127044597181333653557137,
            158134588295867854248363242979867335495870614408289867559688757020606285139972388523872699906128344801196982686332316037529401537215408864174017508962718917449854736680666089792950736818408794395227500116118447569
        ),
        Product(
            11962664336317365592129676381687751162655690612278974376479822801430129357328934563820072978518879847543153514515736283643525535738702686160631865703471774553687154841575733383965328888045246714775515158210476941,
            79960966879595022642129942130228652508277510934706828726996710304296127809514457347639435172205144244104236649657816211722512791516591639073697207596890282543066771835795691566505093093776122777710022373301609021,
            627725070700442815544909860660141468903564396865375655439493859632938893118786724217295408399122274105290739682746793410136576796394030426428945795071650485790847019844789799148075415862163735506904663828202395221
        ),
        Product(
            50177127413263370743917196485032221796940183973972318867645029346203147035227566221899566179617228041914769270721288135617550568924749733913900781498624135274062010222232857641178447993418528335271809457522441991,
            472721358261797019113746219516882510613278575333739214595182118577387543121354439669474860323762306289618089445216346119765344833554221177399381046750195800739847359462088500935312746885364030105981783836658795591,
            662866262143637160880169279881215140580630851445634317672573808731420521360111532720883742688627591501084583523739122212631852252637483326967847166113403050199450766620023540417673181386739505902801272307270154711
        ),
        Product(
            92216842294684463676497171209272306982047760964371211687835578522501616406028207616860511130753614206642564142420760356333787688706908095587351899862511022567791179473494011189240037068480265357909938682837537603,
            868779724776237842004894402445249628936134169085391941690661502922515228246265745443054289073941944367843104289121900199144631383080871005796631056599445949454453743460812000151261401855682499950835738117258906883,
            4838957461463179488708825247139183687426400930604110423830109041417584818779480157579469978808492282316980865789131477645515069770567756384241570745417025763162516101845975218719595629330253924307168887725738157327
        ),
        Product(
            49693583427574795394658709187231073505333564069598094447228840935535605884223665067992230854037157421458224967409418983869246972081224191349265852605251902439748212682002228374617575945140235260843307472354686083,
            656478391595856507582070316104999971044143399024690616118654688148391425102112628003476312861227711199263919306303377102693736315388803790982406789679906711177726388588555753791000608538431528972193167134790852979,
            2607605404068003737288143845245756857095661230388910534941429179617315740345841793304644955867107681536518436447746880364086275324472658882906213423549270880654156212839801141552301221963411292371619871049348527567
        ),
        Product(
            68935978660907432004788832084983083963233185895088917465973127161877622924305458485706378984421592472709657130071564578487222683147540689042324935229560860961249738671126041404950657667601060269424945608243435023,
            119929716300482792665865502394422625525076912447620445454501193829567919334065660653215207274267701973070225418069708239285990147393666678196921462659646977288749545359356263814092240051853899372835179345848167779,
            169034796990444251080235629359068109992037538016724879813824517287343760321242151629334819701526918528972994880586439171907025483334380593679125526110841015233749359207281663171043393458912188879822811833911984507
        ),
        Product(
            252018087139931978443155429253984663397328437951990559299158795336552844024715121531434106574955491336887204289739723798995070529919768694009007153923405111082395194610866497919449160443472107347655069677962738491,
            438442425572210428250421089250082907554256323560312342890317356270441249193682471705371664863278731503899656778040341403731150099997405810125259021209211631609098489254521167613288265429054214152769778754811887511,
            866527943453738720400438530722604801544238875697940142247792570266777586989088979512191243154983949665187510640063981829421406890546054002688504049791434012077824573251061520243585469470020533483033184783132155631
        ),
        Product(
            64298357282170230460970139182389664749574850195772593093303420919474878725384668578348224621799082793906739703712596479267935785216366915331734496328716546648027481551955110967249053248627577180571069921381954059,
            111861525682679716007441201043335444153369944861138620860952526805113830111285656293838692150253198833235012909198626751603121160581898606125072342928041115401362878864360261545762051542132908245651039452267235143,
            878157016579776983145030531025239667881179803358702401561965899407074713550801569487851780108680623911301636775362447805892218874804353624462182093694936945316210946675332131977360357381941019849717215227641208163
        ),
        Product(
            341753622318706092868742807405131371879063066633727606004124080918271972292029002147619606590690888941415791630356592427996278967068823006224360215188004058253850727413176357423473414580492992272527504626260230317,
            837998608151347816760341952404363226936332725033386869516961787457132644387303991567450816160735193431690776737449726638511423768566018056358362719433598992156702468588473533956188235752167748175101689426035359269,
            1175070673999934648082937598064218826597874379795419576808700606992962534867113418343185222661142645538292653413965817800370767407318829788524854986468342720845431953160373502921805850132927959731567173440976956293
        ),
        Product(
            112156484301236789741379333457467082791418701285482248705611780251079895299371064397481585327784194301673557897221700211313487988825841126494214396170887079526722873879165543376330220395211392718242405347008269353,
            275013845067416237858998639573789148214574623700018116689102858423880839158731788043139777721553024383555710460310744353768689726025007693732388724857380647058676635950282633758398759599216976665279322700198359097,
            1531781025319631224276098567905406596480060892898983588486232122059269254979081523346426583175353996147514208541507330283281472943278953467325092506607868743673187743253808859537003147041448747124488741520099240329
        ),
        Product(
            202807399819096879094242224473580621778863907815243281631313058805171231942283198144293182660764236119992848113562204318219083970021148504622237204414187192701028498554046838412317213248204830006535427837782043429,
            697324073350593378803490388258475836527326587145562516293966818631479167363192914167364230792490729672852121595946757313328631184593264036440842990520013498191207577220078855362898911305471401803293046401140998637,
            2769849008488213540506294490413149039911333097147911668307111227791174222554196555477538398805232101529217391359198872674855160522069658343950280723300611385245553603539516409549044679567948157760490706222858867093
        ),
        Product(
            127929005001011187592627026392472323142152139594030581067557810822616046511926657709839364923115069613906236940729815207848863236338134983779859746139282425402425513191340775290781855512622127077591628845728568537,
            180309385001425217158112108064980675924765614073476173315691717616128128548306076614655482844390531188104066239296353718149185191374221748792085783928594914543576117017716525803542930210703627928259067428231604473,
            252836065001998488864168374996146087469922732583477762582338665484067934444831425867477799966156554906224137575773099347795784821424188038809014143944566053354400030008082949590442879792662629106106290080928115769
        ),
        Product(
            662003425538884364268130684506166585982311763163802065183365575938188055909594401841164215715734951559480374765369453151212127198411443356774926327142978929385676023941338661274137568705717987742639814882638303681,
            933059946231970875622010964776408022762470910285988737541908961361698126045806282909987359158398081331866040023630961528086384004060223313879620571327505735118393766027556065890319880301759998471909660346395719361,
            5196987521750139458073435373642898316727282109246540621951302985908452690880831642800320654083368084289779005047821612533531423754458338792949618489461023563759992093460745238506418551177959321097731460141656604481
        ),
        Product(
            36401698026026771708842353588233162181524214132017723041540539260652977983917727216820278169619322617665267397554355473200594166846428030151058712438609763668975716682240882080394760526555722795273902647587262343,
            71943513421517477944247486225563178799705336591625578609658861058455885621758657727731415910035039189243953675481442706876764849436641224944218400173945280952070117222381585843929802300515641115068894209011046047,
            285767660881485759005636429350145375551020799130879290333983603487173378346188771930471002638665075982773792089462144935283404601148730283941775876388141215574557397891292593969713198779339020684158117634996067363
        ),
        Product(
            251460423412037606615504525165617490624557079636951127463615187588026164628939680328168923775504715877943407491358786128742221116938509569535400178723604982025702931708648827181150183214175487336820662597784202801,
            352606515510734297544646010148435699143931994351255491583058168070360711295328825488102792556713316678010029499056174962649706705874669843315002485249300840717605786921066232527758078138313113528167521296334273201,
            1400592414200008345227139729553746581858566527363353486487286826956771430922083023950750932984235763856478085301031898158413376835685441568864770827862760709942043703427502126813445433880072407121844696145200280401
        ),
    ]),
    ("Dickson pseudoprime", Mueller, None,
     [Product(23, 29, 37, 71, 79, 113, 197, 239, 307, 379, 701, 883, 1429)]),
    # Determinsitic tests often use bounds up to which a small set of bases
    # is sufficient. If these bounds are mistyped then they may pass.
    ("bound for deterministic tests", None, [bound_deterministic], [
        2047,
        341531,
        1373653,
        9080191,
        25326001,
        1050535501,
        3215031751,
        4759123141,
        350269456337,
        1122004669633,
        2152302898747,
        3474749660383,
        55245642489451,
        341550071728321,
        7999252175582851,
        585226005592931977,
        3825123056546413051,
        18446744073709551615,
        318665857834031151167461,
        3317044064679887385961981,
    ]),
]

def factorial(n:int) -> int:
  res = 1
  for i in range(1, n+1):
    res *= i
  return res


def primes():
  """Yields a list of primes."""
  for i in (2, 3, 5, 97, 101, 251, 257):
    yield "small prime", i
  for i in (127, 521, 607, 1279, 2203):
    yield "Mersenne prime", 2**i - 1
  for i in (11, 77, 116, 154, 320, 399):
    yield "Factorial prime", factorial(i) + 1
  for i in (38, 94, 166, 324):
    yield "Factorial prime", factorial(i) - 1
  for i in (10350794431055162386718619237468234569,
            65537, 6700417,
            761838257287,
            581283643249112959,
            13842607235828485645766393,
            67280421310721,
            5702451577639775545838643151,
            59649589127497217,
            5704689200685129054721,
            93461639715357977769163558199606896584051237541638188580280321,
            6969336604531667168509871230100794095801832527002849548226132675916172927,
            7084851186360580941633572744569751943590093912197024061201633650193388126309578906138706239):
    yield "Factor of Mersenne number", i
  for i in (3303820997,
            3247414297,
            2693454067,
            4244438269,
            3340530119,
            1030792151,
            1056139499,
            1775253149,
            5887258746928580303,
            9097024474706080249,
            4898287974374852689,
            3770881385233444253,
            14246000373755891347,
            6430974998173972123,
            10335409800163507643,
            1159509627490314673,
            333610163647978885748406477874282560251,
            16715625041730310485920156154542999861,
            280428139514649613212487868665268265467,
            160176298528945003409007136253131674373,
            10350794431055162386718619237468234569,
            141588754971700831923840928609540336261,
            203184284229028394950989663062394770411,
            296419181658219306038085634872587616223,
            79400289762731105433305818291671708242242275199296386769913771891140431753099,
            57512627104627249382568370037427768801293038741212200681849793381413806112551,
            70361700158560558941595766010063944006532478720269625038330685019162523752497,
            45531021117268044907072822448525983726734904149962457316912463172772228620893,
            57707458154102208142691728685111563197232272488087968397514691704269409885701,
            43018732843584964244051139941308201060038384395903615123018297464240172002453,
            68050120136391979464314025035875047384537129449653377635496610909265870034547,
            73736851015530652291523411760980435267336576191436969352003255675741290787659):
    yield "edge case for Montgomery reduction", i

def pp():
  from pprint import pprint
  for comment, flag, values in NONPRIMES:
    print(comment, flag, values)

def test():
  for comment, flag, values in NONPRIMES:
    for f in values:
      v = int(f)
      if is_probable_prime(v):
        raise ValueError(f"{comment} : {v} is prime")
      if psw_test(v):
        raise ValueError(f"{comment} : {v} passed psw test")
  for comment, val in primes():
    if not is_probable_prime(val):
      raise ValueError(f"{comment} : {v} is not prime")
    if not psw_test(val):
      raise ValueError(f"{comment} : {v} failed psw test")

if __name__ == "__main__":
  test()
