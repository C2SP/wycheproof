# Copyright 2025 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

import ec_groups
import flag
import util
from collections.abc import Iterator

# A list of private keys where the public keys
# have some special pattern.
EDGE_CASE_EC_KEYS = [
  (ec_groups.curveP224, (
    ("lby:", 1551746054134065593735068216007347411501007898473820610849108762417, 34),
    ("lzy:", 1551746054134065593735068216007347411501007898473820610849421154404, 33),
    ("lbx:", 25408200613016574200931946871012278528956799815950571110835639132311, 32),
    ("lzx:", 25408200613016574200931946871012278528956799815950571110836659799410, 33),
    ("miny:", 14595352801567907706585203412044757262122805890713372609619197482756, 9303986004),
    ("minx:", 25408200613016574200931946871012278528956799815950571110834208177533, 4435439879),
    ("maxx:", 25408200613016574200931946871012278528956799815950571110834472458338, 52042960705),
    ("miny:", 1551746054134065593735068216007347411501007898473820610846177160058, 77612063796),
  )),
  (ec_groups.curveP256, (
    ("lbx:", 114856153830188569448850364328654611442954821266455375521461967094002399737306, 33),
    ("lby:", 114856153830188569448850364328654611442954821266455375521461967094002582270340, 32),
    ("lzy:", 935935380167679313847082620752962087042133957680384820960291967065929774029, 32),
    ("lzx:", 114856153830188569448850364328654611442954821266455375521461967094002759768606, 33),
    ("maxx:", 114856153830188569448850364328654611442954821266455375521461967094003006163724, 751048802),
    ("minx:", 114856153830188569448850364328654611442954821266455375521461967094003187394775, 1079979298),
    ("miny:", 69566863052418533538274175812124768124295276675758719495044627996071968902972, 56901202545),
  )),
  (ec_groups.secp256k1, (
    ("miny:", 8153742731793028209175290266411461296717323479429768761380011571096058070964, 4196323123),
    ("minx:", 8153742731793028209175290266411461296717323479429768761380011571096194178322, 3437898677),
    ("lzx:", 25698040554380275507905286106944039226787781120643098724998977158437260190912, 34),
    ("lzy:", 90094048682935919915665698901743868626049783158431805657606185983080842450743, 34),
    ("lbx:", 25698040554380275507905286106944039226787781120643098724998977158437487179783, 36),
  )),
  (ec_groups.curveP384, (
    ("maxx:", 21520164109922222528982264090062642868111985847381173745333691479316503682472480696735933267813017496961125736996169, 12843322502),
    ("lby:", 17881842086472256683296776010080970936967753423084272922613213800311155716640782872663023040339277416593307607040545, 35),
    ("lbx:", 21520164109922222528982264090062642868111985847381173745333691479316503682472480696735933267813017496961126116544342, 35),
    ("minx:", 21520164109922222528982264090062642868111985847381173745333691479316503682472480696735933267813017496961127329985843, 25550029158),
    ("miny:", 21520164109922222528982264090062642868111985847381173745333691479316503682472480696735933267813017496961127344017772, 33785453786),
  )),
  (ec_groups.curveP521, (
    ("miny:", 1568749017585718607907551406122789796437152408071784209969576792329967475271372424592615235527004242526270118537252109880232422956664194115581651824292376675, 14132842022),
    ("minx:", 5787148748199645005482467209761840024808382688523216820978826777936054929990837009075879144742379066920295667882508571300447727834664814820505071908726965135, 2879618552),
    ("maxx:", 5787148748199645005482467209761840024808382688523216820978826777936054929990837009075879144742379066920295667882508571300447727834664814820505071908990317297, 4556282022),
    ("lzy:", 1568749017585718607907551406122789796437152408071784209969576792329967475271372424592615235527004242526270118537252109880232422956664194115581651824352575013, 32),
  )),
  (ec_groups.brainpoolP224r1, (
    ("lbx:", 9013250208254582494915270980269010042702972056649395502346235677283, 34),
    ("lby:", 9013250208254582494915270980269010042702972056649395502346504489712, 35),
    ("minx:", 9013250208254582494915270980269010042702972056649395502346741772192, 7135097936),
    ("miny:", 13708372724199770292637267015641913569864574285681361689049530953967, 23162345906),
  )),
  (ec_groups.brainpoolP224t1, (
    ("lzy:", 7265858840052174918319791140811830919955304396540179070069117540391, 35),
    ("minx:", 15455764092402177869232746855099092692612241945790578121328230318859, 5355761918),
    ("miny:", 7265858840052174918319791140811830919955304396540179070065873189503, 88101455822),
    ("lby:", 7265858840052174918319791140811830919955304396540179070067798005152, 33),
    ("lzx:", 15455764092402177869232746855099092692612241945790578121330698467144, 34),
  )),
  (ec_groups.brainpoolP256r1, (
    ("maxx:", 39381622850470953970125238924960396846088736479777187998780194933127817298510, 11475515353),
    ("lzy:", 37503333546574390250684507704041252246648795304637341539975324129935393060162, 32),
    ("minx:", 39381622850470953970125238924960396846088736479777187998780194933128187989969, 2452391814),
    ("lby:", 39381622850470953970125238924960396846088736479777187998780194933128348240679, 33),
    ("miny:", 39381622850470953970125238924960396846088736479777187998780194933128660241241, 2235189874),
  )),
  (ec_groups.brainpoolP256t1, (
    ("lzx:", 62951430048635043820072108198615197221951690665127962176383305934260044960328, 33),
    ("miny:", 62951430048635043820072108198615197221951690665127962176383305934260098599893, 9881623214),
    ("lzy:", 13933526348410300400737638430386451870785841119286567362372213128803124063207, 33),
    ("maxx:", 62951430048635043820072108198615197221951690665127962176383305934260732842503, 5339181307),
  )),
  (ec_groups.brainpoolP384r1, (
    ("lzy:", 19664275714005473436680514267054785514859555516508002245861025387221903248165292049874561608954347515506013484088215, 33),
    ("maxx:", 19664275714005473436680514267054785514859555516508002245861025387221903248165292049874561608954347515506013941375819, 3341582754),
    ("lby:", 1994995056113842736388722575277819464936560870509646354214619887599708253193223488088133508414555736723587746698643, 36),
    ("lzx:", 19664275714005473436680514267054785514859555516508002245861025387221903248165292049874561608954347515506014143765681, 32),
  )),
  (ec_groups.brainpoolP384t1, (
    ("maxx:", 15375180767535732312636004705003897872269346720175585995821216099275467236272475710833428829578671369772659957928795, 132020549),
    ("minx:", 20579699435455424241689515413965734076838276747856861413204511064717399319218704128471886026867198634216973363681337, 8083223222),
    ("lbx:", 20579699435455424241689515413965734076838276747856861413204511064717399319218704128471886026867198634216973768654875, 36),
    ("lzy:", 20579699435455424241689515413965734076838276747856861413204511064717399319218704128471886026867198634216973399391962, 38),
    ("lby:", 1079571334663891931379721428366870902957839639160787186871134210104212182139811409490809090501704618012629934391358, 35),
    ("lby:", 20579699435455424241689515413965734076838276747856861413204511064717399319218704128471886026867198634216972252464811, 36),
  )),
  (ec_groups.brainpoolP512r1, (
    ("miny:", 7566909534742260858886734557454993583053618754837684381906321123279345427097800038455549255985032241145224106849312955101252457897465370423162399638509765, 27910968022),
    ("maxx:", 1382052672907971692769868257704159839108990889260670129438276063920711583315618489923432474658492718712227291520716325481841757716416673550191988676606245, 22471727399),
    ("lby:", 1382052672907971692769868257704159839108990889260670129438276063920711583315618489923432474658492718712227291520716325481841757716416673550191989325335391, 37),
    ("lzy:", 1382052672907971692769868257704159839108990889260670129438276063920711583315618489923432474658492718712227291520716325481841757716416673550191989458574479, 33),
    ("lbx:", 1382052672907971692769868257704159839108990889260670129438276063920711583315618489923432474658492718712227291520716325481841757716416673550191989865186469, 34),
    ("lzx:", 1382052672907971692769868257704159839108990889260670129438276063920711583315618489923432474658492718712227291520716325481841757716416673550191991344380234, 33),
  )),
  (ec_groups.brainpoolP512t1, (
    ("miny:", 6410703424817630141863540183882584693788486792187123466807077774043328499892413689540304919106889696213328889542875801901337121458348823282052772517030940, 7839643300),
    ("lzx:", 6410703424817630141863540183882584693788486792187123466807077774043328499892413689540304919106889696213328889542875801901337121458348823282052772592792407, 33),
    ("lby:", 2538258782832602409793062631276568728374122851911231044537519413156728510521004838838676811536635263644122508827153478681757094155533220691301618946060643, 33),
    ("lzy:", 6410703424817630141863540183882584693788486792187123466807077774043328499892413689540304919106889696213328889542875801901337121458348823282052773414346758, 34),
  )),
]

# A list of EC points where both coordinates are some edge case.
# TODO: Add more curves. Examples for curveP256 are too small.
EDGE_CASE_EC_POINTS = [
  (ec_groups.curveP256, (
    ("miny:", (0x7fffffffffffffffffffffffeecf2230ffffffffffffffffffffffffffffffff,
      0x1c7c30643abed0af0a49fe352cb483ff9b97dccdf427c658e8793240d), 2412469831),
    ("lzy:", (0x7fffffffffffffffffffffffca089011ffffffffffffffffffffffffffffffff,
      0x267bfdf8a61148decd80283732dd4c1095e4bb40b9658408208dc1147fffffff), 32),
    ("lby:", (0x7fffffffffffffffffffffffca089011ffffffffffffffffffffffffffffffff,
      0xd984020659eeb722327fd7c8cd22b3ef6a1b44c0469a7bf7df723eeb80000000), 32),
    ("miny:", (0x111124f400000000000000000000000000000000,
      0xd12d381b0760b1c50be8acf859385052c7f53cde67ce13759de3123a0), 328523670),
    ("lzy:", (0x1f6bd1e500000000000000000000000000000000,
      0x4096edd6871c320cb8a9f4531751105c97b4c257811bbc32963eaf39ffffffff), 34),
    ("lby:", (0x1f6bd1e500000000000000000000000000000000,
      0xbf69122878e3cdf447560bace8aeefa3684b3da97ee443cd69c150c600000000), 34),
    ("miny:", (0x1ea77d449ffffffffffffffffffffffffffffffff,
      0x7afbc0b325e820646dec622fb558a51c342aa257f4b6a8ec5ddf144f), 8940324840),
    ("lzy:", (0x2099f55d5ffffffffffffffffffffffffffffffff,
      0x152c1a22d823a27855ed03f8e2ab5038bb1df4d87e43865f2daf6948ffffffff), 33),
    ("lby:", (0x2099f55d5ffffffffffffffffffffffffffffffff,
      0xead3e5dc27dc5d88aa12fc071d54afc744e20b2881bc79a0d25096b700000000), 33),
 )),
  (ec_groups.secp256k1, (
    ("lzy:", (0x800000000000000000000000009fa2f1ffffffffffffffffffffffffffffffff, 0x7ed353c9f1039edcc9cc5336c034dc131a4087692c2e56bc1dd1904e3ffffff), 27),
    ("miny:", (0x80000000000000000000000000a3037effffffffffffffffffffffffffffffff, 0x31a6bf344b86730ac5c54a7751aefdba135759b9d535ca64111f298a38d), 5406407),
    ("lby:", (0x80000000000000000000000001126b54ffffffffffffffffffffffffffffffff, 0x4106a369068d454ea4b9c3ac6177f87fc8fd3aa240b2ccb4882bdccbd4000000), 27),
    ("miny:", (0x8000000000000000000000000124dcb0ffffffffffffffffffffffffffffffff, 0x13bc6f08431e729ed2863f2f4ac8a30279695c8109c340a39fa86f451cd), 13601262),
  )),
  (ec_groups.brainpoolP256r1, (
    ("lzy:", (0x7ffffffffffffffffffffffffa1c6646ffffffffffffffffffffffffffffffff,
      0x5407f4a41e7904d3e7a9e6e6d70b093361dc5ea097c3767e1013f5868fffffff), 29),
    ("miny:", (0x7fffffffffffffffffffffffe966ec89ffffffffffffffffffffffffffffffff,
      0x93b3d1910bada32f99c20977cff951d97072fea058e879c4bfeefd404), 308926188),
    ("lby:", (0x7fffffffffffffffffffffffe8e61519ffffffffffffffffffffffffffffffff,
      0x8a3af7f7a8a00701cfee7f390f84ed21d374623c20e5c822760d9de3b0000000), 29),
  )),
  (ec_groups.brainpoolP256t1, (
     ("lby:", (0x7ffffffffffffffffffffffff1b9cb97ffffffffffffffffffffffffffffffff,
      0x7bca76a7bdd3186966bde7a7f33d34deed65da0e6bd539ec91a954e140000000), 31),
     ("miny:", (0x7fffffffffffffffffffffffc6411cefffffffffffffffffffffffffffffffff,
      0x32fe3a4b2f3307c2677b6c88bbb62ae65e8cbbe2067709ed0cb320c8), 14316969188),
     ("lzy:", (0x7fffffffffffffffffffffffbb95fc9dffffffffffffffffffffffffffffffff,
      0x1e15c9e0bcb3c4e417f060296b23b8f476d0301015e3685532a8a6393fffffff), 31),
     ("miny:", (0x285b925cffffffffffffffffffffffffffffffff,
      0x194a684fff9e633894a52706d3cc5aedaa2d1e1867ffd0923e983d1), 461872631263),
     ("lzy:", (0x101f5e4a2ffffffffffffffffffffffffffffffff,
      0x7b8e2c449f51c72f057d077dade6e243aba0ffcaaacdcada8f8a73147fffffff), 32),
     ("lby:", (0x162c3958cffffffffffffffffffffffffffffffff,
      0x44706794abaa4ba875118833c04ebb90b6f0e92e8ac66671c6e46dcb00000000), 33),
  )),
  (ec_groups.curveP384, (
     ("lby:", (0x1f03123b00000000000000000000000000000000, 0x71bd1e700c34075c3cade8ce29d33724af68a7672b265a4e157055360440ab7c461b8e9ac8024e63a8b9c17c00000000), 35),
     ("lzy:", (0x1f03123b00000000000000000000000000000000, 0x8e42e18ff3cbf8a3c3521731d62cc8db50975898d4d9a5b1ea8faac9fbbf5482b9e4716437fdb19c57463e84ffffffff), 33),
     ("miny:", (0x36a2907c00000000000000000000000000000000, 0x7f57b69a014783dbfa4967b2f9cfa678a6f0b6e9cfd41648cec5b3c498e72152da3f82d3da2e8e9f8ef37b11), 8634277676),
   ))
]

# A list of edge cases for point doubling.
EDGE_CASE_POINTS_DOUBLING = {
    "FRP256v1": [
        [
            "edge case for Jacobian and projective coordinates",
            109454571331697278617670725030735128145969349647868738157201323556196022393858,
            48294897411905766206314830376719452473869673775107257063011109543087115873979
        ],
        [
            "edge case for Jacobian and projective coordinates",
            77530768783212810393881464152969388549724320527871728623720801894996216997488,
            26629565553883797706519807395460540256886929072245374451392823925629930635768
        ],
        [
            "edge case for Jacobian and projective coordinates",
            63828237422830485986368792883058523795574630843215967270070620397835013424135,
            21965597684872702842151586080646527363098326447020297115854178055211788894950
        ],
        [
            "edge case for computation of x with projective coordinates",
            80053962852101671685319811855630470565056299959876384269231754140297156147554,
            36542344604655751577543395003188096369546661791467208490140324979377019665454
        ],
        [
            "edge case for computation of x with projective coordinates",
            52244634956643475856483520923350835327521741304873779266638543967086457346367,
            21869800132102131374173250426061051474212443662075961069581254978181954613024
        ],
        [
            "edge case for computation of x with projective coordinates",
            106634000132190626774951949328809296177072193993939717094514411126013474146016,
            34931386785098517708865540099213491814576116260468255604891781971432310516086
        ],
        [
            "edge case for computation of y with projective coordinates",
            11590460789568194790117677101296208321097706975377320219581709270713357325294,
            36609849408399307725889435433272964535409972583127143657385335468932951810791
        ],
        [
            "point with coordinate x = 2", 2,
            48294897411905766206314830376719452473869673775107257063011109543087115873979
        ],
        [
            "point with coordinate y = 2",
            92955971884091510294049494123748161449182187639204491368818912230998880223709,
            2
        ],
        [
            "point with coordinate y = 2",
            100488743063674338554358406161341918534520961898667445332328926329113093708193,
            2
        ],
        [
            "point with coordinate y = 2",
            25464427715628708386933549776380176308235549757865539613254808552280070855816,
            2
        ],
        [
            "point with coordinate y = 3",
            94024636421988831964228584284194221181052033809020753861913811153604826774831,
            3
        ]
    ],
    "brainpoolP224r1": [
        [
            "edge case for Jacobian and projective coordinates",
            7553097459164967925136318203776274677622021205876722840412904380725,
            1290123097053955064702013062893044961284707613266196418995503031838
        ],
        [
            "edge case for Jacobian and projective coordinates",
            15184590948180978364854044418347807480837141913899521422288566477471,
            10706608749386897794815061031054028318458621116990397188127573696671
        ],
        [
            "edge case for Jacobian and projective coordinates",
            7537031984273374422698493577563120592503590232045470882146906463840,
            8406683565946142989043628921368495762877962343236797112766071268528
        ],
        [
            "edge case for Jacobian and projective coordinates",
            1303332845931316562847113699288005832044222925319565355767262109082,
            1264371660410777849737345530177859713959160117492823927261204766913
        ],
        [
            "edge case for Jacobian and projective coordinates",
            21418290086523036224705424296622922241296509220625426948668210832229,
            2699269854239699877729639421667589948807469128115837645563623135701
        ],
        [
            "edge case for computation of x with projective coordinates",
            11627788873998113447008674144483972140535980194967995103400404248544,
            5877878674282329184559311263982208943625913635016487130281389489186
        ],
        [
            "edge case for computation of x with projective coordinates",
            11536206245604010271363444019998905037128577962661476682153346582200,
            5033163110769366707815509017668066285438425278214493955354524289478
        ],
        [
            "edge case for computation of y with projective coordinates",
            16804629563623509095509765653237587525305432766809714014887738211608,
            8280211274707387166178462186294194952227136491486237683028390208585
        ],
        [
            "edge case for computation of y with projective coordinates",
            1404113847301913746601249498133506340143972539572877430059189445035,
            11105352296481728570795362470234052863859807779315962960118870813456
        ],
        [
            "point with coordinate x = 1", 1,
            8291929620927382212175942700386424404862978758691189343816908723317
        ],
        [
            "point with coordinate x = 3", 3,
            8367126734052597193113206661274526559349132177120301568233377980767
        ],
        [
            "point with coordinate y = 1",
            2821635179009884010230416522099814199081938126243182459493496625095,
            1
        ],
        [
            "point with coordinate y = 2",
            12277382796118980175543396909425909800718027427058497808811013890510,
            2
        ]
    ],
    "brainpoolP224t1": [
        [
            "edge case for Jacobian and projective coordinates", 1,
            10450309951971436295675097757305858865366267271332404870562549279411
        ],
        [
            "edge case for Jacobian and projective coordinates",
            22721622932454352787552537995910928073340732145944992304435472941310,
            8604305719794538854954672306725890988731877133022142159402141725156
        ],
        [
            "edge case for computation of x with projective coordinates",
            8763066394786660827354379089247510937704488355252952405784155280022,
            8990708270486358591133527148808069123304888401761413186553261315276
        ],
        [
            "edge case for computation of x with projective coordinates",
            6723061788588814287042279836080586412772372997252035426320572123540,
            5173189166520945181764013106073833119710343807477701385748486562308
        ],
        [
            "edge case for computation of x with projective coordinates",
            1303601513268080715966340145792674847623118119125991751029309170683,
            8446948792258025994006039442932414719212879883042528884923633001744
        ],
        [
            "edge case for computation of y with projective coordinates",
            3191290333564382891006689021622299579961177727254325017436591673625,
            8039273897059566425280035963904428669264252160649984329858842265198
        ],
        [
            "edge case for computation of y with projective coordinates",
            4680013464846461117289699273594960770125814175644684369419416376017,
            1009848194165701869337619986465174385235416380598651369060079156809
        ],
        [
            "point with coordinate x = 2", 2,
            8604305719794538854954672306725890988731877133022142159402141725156
        ],
        [
            "point with coordinate y = 3",
            818459759576750984681146522138087843922127969523981444339857962531,
            3
        ],
        [
            "point with coordinate y = 3",
            3361938634090426313284514291717262203719647267758542633636573759666,
            3
        ],
        [
            "point with coordinate y = 3",
            18541224538787175489586877182055578025698956908662468226459041219114,
            3
        ]
    ],
    "brainpoolP256r1": [
        [
            "edge case for Jacobian and projective coordinates",
            54962278827379567661432748084655882703916091846452196556737014072997764593702,
            13652122415210100601070651827662893178290866134803629602685596392946166439259
        ],
        [
            "edge case for computation of x with projective coordinates",
            27488004993192618832614532272409553942659988036582208185885766583257426111545,
            10310583073179136174648250212183772546220226478462133030182527139594416174002
        ],
        [
            "edge case for computation of x with projective coordinates",
            4782197610608634202126283441211513755833597258290005518637640717553417629385,
            17516322174065690381664509961119568731574294825852104201155176784087733730474
        ],
        [
            "edge case for computation of x with projective coordinates",
            57842880530454362172797226052750555386178930977221049959957820892834812391103,
            10371175657013069244067365434770890809425550373342811357767660212786360251913
        ],
        [
            "edge case for computation of x with projective coordinates",
            29457676939647298219923566449517687623143330550232576526100690760783299405058,
            18993241857982705875308789918355312816580591286486082150985853145499758093409
        ],
        [
            "point with coordinate x = 1", 1,
            4468203764278075311591596375553603158607670996956465706621415242362682151117
        ],
        [
            "point with coordinate x = 2", 2,
            17550075722194392900088445006376910450288573168117452878635446248251452733698
        ],
        [
            "point with coordinate x = 3", 3,
            13819529412999298679029662313270701143315844572676910644067433328131763596429
        ],
        [
            "point with coordinate y = 1",
            16732697965907343965806143232107577125064123267052623282736422190483944893463,
            1
        ],
        [
            "point with coordinate y = 1",
            8576153280992625183233398425509006353384836967328720405878699290028912981504,
            1
        ],
        [
            "point with coordinate y = 1",
            51576105150145375071770204971385065614588989966561711515120479964518658322784,
            1
        ],
        [
            "point with coordinate y = 2",
            11871032018141616211327107235880879586069322888218673284232496894767342513945,
            2
        ],
        [
            "point with coordinate y = 3",
            37796688645900313523109611948515627118955109623388337731034947619584897244030,
            3
        ]
    ],
    "brainpoolP256t1": [
        [
            "edge case for Jacobian and projective coordinates", 1,
            14367619176494090355530400803171106407832135346605942612316810525581467700465
        ],
        [
            "edge case for computation of x with projective coordinates",
            31866589544486619690704166971354243666549910165878747882692259518181197078684,
            26909192472400783093194226473384375834542270737839739748144858712967167089867
        ],
        [
            "edge case for computation of y with projective coordinates",
            25806694323770512137172822606266933898638103763217840217322911975118345722843,
            23898924050433647814514226576057356703102454869165968167543675409268857719894
        ],
        [
            "edge case for computation of y with projective coordinates",
            43229675971436715050075827924273572030873367309626312688694122252329743830934,
            6269548240264521220008822793644297030554541481784683528012493143794634766837
        ],
        [
            "edge case for computation of y with projective coordinates",
            75031058918127854740360114969689560024266824520991665965275885290204460381742,
            2625320197897750738493987284602582987560457966908316780331052002664936067696
        ],
        [
            "edge case for computation of y with projective coordinates",
            74660157711465264419725545349156061689077911134824198793863115752175604237745,
            4881655318639600135852876947348893599830255135147017286684469895831769060273
        ],
        [
            "point with coordinate x = 3", 3,
            5000928082378168533440782673631712003296809233007744901306252446324951099841
        ],
        [
            "point with coordinate y = 1",
            12491719670433013883202018424752182146184391487385322826814059249652657598215,
            1
        ],
        [
            "point with coordinate y = 2",
            11136040853537751712550565365537573742408232215773779562222538051642638653040,
            2
        ],
        [
            "point with coordinate y = 3",
            52554412207097718285344956705346618837635732660778037736109147451787968789222,
            3
        ]
    ],
    "brainpoolP320r1": [
        [
            "edge case for Jacobian and projective coordinates",
            1633299620974690895195593651827056466346500604153484718463072357730821275790035501196533138604967,
            823737656177441260702651199399804654946792129098552240273339575943543315160873530024179869010570
        ],
        [
            "edge case for Jacobian and projective coordinates",
            1448479766240549903406313877249065474190840113772972066196819343420460496707612040438434990235568,
            590248740752887362484811736582125941865888956448036926175823415791103645970424455522586237047333
        ],
        [
            "edge case for Jacobian and projective coordinates",
            315113555998616450755595965196954046698672658946543126576141071868180372094537777657066509667959,
            772672225911677405931406915077334646068721849069328570070564875327711809621375289339912740357421
        ],
        [
            "edge case for computation of x with projective coordinates",
            107168460527356579755728051840669662405749056819006408729686870701942552510358324852139800505888,
            343241702449279262263398633963735178187750710811346547950175282243858425179388171516369312798575
        ],
        [
            "edge case for computation of y with projective coordinates",
            1598289955807642323208181646700613472935706055748941214731536849025310023365141344524640374141477,
            184693451663149864307698154029286348987693194210892947654614383988090255686012583131060587228280
        ],
        [
            "edge case for computation of y with projective coordinates",
            865082101030079905978608100275256107724559783373866466595353020809721307096542143459859762051215,
            317081697767384910575641349035233342367849338097557026844895869136430792029305928469194421834971
        ],
        [
            "point with coordinate x = 1", 1,
            342646043828726495801429089897528786949660735977831434864385085003828502065168677446897178646399
        ],
        [
            "point with coordinate x = 2", 2,
            109318650020540942985534105132168786352907648193924778282268337704749771687526574536390784918952
        ],
        [
            "point with coordinate x = 3", 3,
            830567284394650856233373898979457084073400062522824249008784455448620842548563650864360619150754
        ],
        [
            "point with coordinate y = 1",
            844909973444807843107859740900328403871375707559503699955224626693497965699465026111994597261771,
            1
        ],
        [
            "point with coordinate y = 3",
            1656717433534790667528067283990252557283117589396427156399779481770661413888455203709252607187444,
            3
        ]
    ],
    "brainpoolP320t1": [
        [
            "edge case for Jacobian and projective coordinates",
            104063219227926162693724795042170633282717737260703249602103187224600687830767139342971250986743,
            282399902993153565363893943509717542011854582211449145294187886480048188051212358431227322795038
        ],
        [
            "edge case for Jacobian and projective coordinates",
            1659530103011240191468185047403848887606795035458811943170857228064040180971382678752530248916784,
            372725949034370657343741356213785564636882315653178992702768682743478672171760557300344656124574
        ],
        [
            "edge case for Jacobian and projective coordinates",
            316966331177177855121645045297640376797851313208771965815458690974064521530920005929567241526948,
            210512838230277685872354006874250775433055358777371476145648932237286756775660078010467270220527
        ],
        [
            "edge case for Jacobian and projective coordinates",
            1763593322239166354161909842446019520889512772719515192772960415288640868802149818095501499903526,
            9150580575620713837691980393685760426902900183656494985235569497235008475928198187760484784477
        ],
        [
            "edge case for computation of x with projective coordinates",
            906989578021860841908659524707078963618783313619069992496092141771959701687148447406079951761500,
            784180120118563359719804476876046458393627257255604371654388750465804643927250765867836700915655
        ],
        [
            "edge case for computation of x with projective coordinates",
            1125097123689857282073148934899563774477683890338904679427390856472817142059910800345126854516118,
            301302659099067699641188345337556739030422284674496667596384247187119884635258569330900214919328
        ],
        [
            "edge case for computation of y with projective coordinates",
            1600419639802408462075379236270025095529516328635056058729261412787428070505342179331079820180802,
            870332897714075327942134901846488569129370674150292380077633867564975171748925204599025209378526
        ],
        [
            "edge case for computation of y with projective coordinates",
            1590100777144700925439537287846438056198363816933964598540361059103933261920275874993174068565537,
            847533516423200837793529978101979485575274252432823962003975065576544344731547167418512879491714
        ],
        [
            "edge case for computation of y with projective coordinates",
            1232752320414191420001585084962172858209484748527028915940148963652607522102106258997414142443928,
            202271350826647010860055721422508723669764498241155063273881807828819879205808207925562569687461
        ],
        [
            "edge case for computation of y with projective coordinates",
            506246427387843864454725383763805972754719058910919991608628959682448898175663892771729268089123,
            617195074035222793044958282362120294868133945528020531856632157743136518380498774754041558989127
        ],
        [
            "point with coordinate x = 2", 2,
            9150580575620713837691980393685760426902900183656494985235569497235008475928198187760484784477
        ],
        [
            "point with coordinate x = 3", 3,
            65081915349441066258392370777460668607299889291295842104529943707888767587479342479850119802688
        ],
        [
            "point with coordinate y = 2",
            217392264520275926929098255279298247579797029262026483440283315862444383783354735612815235034144,
            2
        ]
    ],
    "brainpoolP384r1": [
        [
            "edge case for Jacobian and projective coordinates",
            13312064335845374626643486976488040182324069710441328896702380328314702613406400355832207791660422804330380750347291,
            7218687038834688233962281572072386787662168319742767503793543314982145638695362530026245686972661007552288360948851
        ],
        [
            "edge case for Jacobian and projective coordinates",
            8289585267910302676458642381174115417927077646804525267710982913322062733197874430964227475384282322428081309966209,
            3300945627984257039171136155817532638244826664483185461488225196377891776684157110561735488625152903896830699432834
        ],
        [
            "edge case for Jacobian and projective coordinates",
            13369685502209013496610594461158489561869038740213123332370635590499027200828087391272334507460251766012627108007122,
            8750160407542388719714525943336502160906295618898126063431059785961224686113468748568507449765802259576286340790583
        ],
        [
            "edge case for Jacobian and projective coordinates",
            14695650696132738375999713229579460750066613466821030168920430404247198583641599790063416664689056807032383852745801,
            9178844673140022923373656571878845813690499154615333514733380109561749293136372596487658927524395536715072782925715
        ],
        [
            "edge case for computation of x with projective coordinates",
            348709192567780910654424111047956644716782193933088422898343721159494455659207534273465830339602124510212966359317,
            5686768388686066436884846574023897843270908158632122634566326684713547314203611345850895258082717536361213597663509
        ],
        [
            "edge case for computation of x with projective coordinates",
            21488178001939752530251586720922404140057813672395567713386962031656742883322559602517614405565670428767438305858701,
            5491631664570651103523346698343803073936157065024857334771012310393815125625594668273610232669737033153211987531701
        ],
        [
            "edge case for computation of x with projective coordinates",
            8243600761241058286531511295897994325852281723741057991897673222012724573783334006632599780449722890649907539083192,
            8692132867111081337967993705002914772129883282417651050053876241127515164377747458306134566820469812661569587549555
        ],
        [
            "edge case for computation of y with projective coordinates",
            14019346337851789400263744856677327249462202392106853808954986068111143550958486789476114021013057892912655617041589,
            7443238595565018086208320643813249679374651200374284544574973148716740688284538327718522298305505632104009453214943
        ],
        [
            "edge case for computation of y with projective coordinates",
            2928178535499379800478981402422130504728931223077681061612868578056125214628563280172571581043707699963721496382209,
            8665503618574265477344931021029465546805792428127913964891558583494334588200681570016577206115488293081313321794267
        ],
        [
            "edge case for computation of y with projective coordinates",
            12731653649775119321007012617533939732686320450171393059213139850548982077042460214856115442347462162133534034130806,
            6860051503494587855424076252131195982003287704345784944995932729076947063351308589257450024382697730485868034484880
        ],
        [
            "edge case for computation of y with projective coordinates",
            12425027943760012947202551817183666255475735377850949625558417771496666698413826990602218470284480629093220821265097,
            5954108456966418505552730778465421528484973583314248268764527251436573038538972735585109992293461514615434509114035
        ],
        [
            "edge case for computation of y with projective coordinates",
            10431090598132040168314808098995073316031319352570194014773310871748781034888299119128281035309957749379412897259338,
            3538524480258135523358683287649381964831326876888943234294294890686173352267609048572653988695728192007766030571072
        ],
        [
            "point with coordinate x = 1", 1,
            10603997135541951140401975772649970903600151922149214724221243084079575442457669667457907980611859656797906598597646
        ],
        [
            "point with coordinate x = 3", 3,
            3524583757167151524906721407776124135726407835003838676637934854376788598111286829009301474365089236512013842781690
        ],
        [
            "point with coordinate y = 2",
            21054011975419335462570900687862333797345908253742169946925895886455190986476387940885634035102409648383240672541841,
            2
        ],
        [
            "point with coordinate y = 3",
            10360584166217797243821930241788433138178700278368007395001657801291781572899496291264845365711706365493559146905217,
            3
        ]
    ],
    "brainpoolP384t1": [
        [
            "edge case for Jacobian and projective coordinates",
            15661143047403795770289117928358842548916105441583452601855726258142648991040618265766368547799227065072059223343472,
            3284225613095934500821456108330115163394580017773435959974841239606999492618199440543742028668138159814706054392000
        ],
        [
            "edge case for computation of x with projective coordinates",
            17591214252600859070796230368994409685585667007664329073076609875439843701074448343493902455682378538856438431007022,
            1116534369397253854319135152499287812300802643202014572640606479190060009663846966029857152950579238599308518862839
        ],
        [
            "edge case for computation of x with projective coordinates",
            16083554371684869119715622186580571795645379015381350912126236958757496386133658106407857936223416216841174600206545,
            7258077091687841763897870262019626619403820397962108938126338049784218852630570620921226793691456299729659037678270
        ],
        [
            "edge case for computation of x with projective coordinates",
            8987657312136337391132419428355076289849813053435438225462488233839733699748160816207681058224484231870770359660532,
            910728265406844208455469889061361459160245749824805593818751357605542240707916111134825606980218293941269324809581
        ],
        [
            "edge case for computation of y with projective coordinates",
            17911649001605889624550915801051010522450714615627520259100441499926400001871864832973110760579006438209662181367524,
            1101664005345907558636036809806513665068099559842104778895318187674532601481241067773053389066736585096423318712311
        ],
        [
            "point with coordinate y = 1",
            14559899132130022596280499820360812003760012580566366845600347284733172751292320973073635432975890424159055833188864,
            1
        ],
        [
            "point with coordinate y = 3",
            20602305625505541645119097168933738249518810360011309875184081666915509982742667785119767218492802794931174457142319,
            3
        ],
        [
            "point with coordinate y = 3",
            10738504860399889866594775597721302374351979462183036684446429857228824579451128053802995251864203898492755271146986,
            3
        ],
        [
            "point with coordinate y = 3",
            11977731054333200834424600918010169335721442951840950640532725483497845305858127805550361495332061483457487107657357,
            3
        ]
    ],
    "brainpoolP512r1": [
        [
            "edge case for Jacobian and projective coordinates",
            2630930345462819166987530558949431190574061218328495227530629502936827633228620005849842272307733975998272371667639877006399944536253622597749512365049204,
            970130920680486479445138677053523429064747396707269301880969982339527376333336274894133683552930321876542709130517195287543338112219294827365164389886245
        ],
        [
            "edge case for Jacobian and projective coordinates",
            3075379284916041790296829348508281667570693996368457698260469365067888821247074384700725090547614567412857186301437526276707138027019881849052904106681455,
            70705806648020369308620695386749295970261350052667775345798893760669601141584705882179145911009732795253182928992716005372236959141471419876079524315128
        ],
        [
            "edge case for computation of x with projective coordinates",
            4762846864888010447688517704933369211260964849653679791163572621763049311562315415057572879965118513823601963456080647007231852881888989016806680557263928,
            355958639447528388112769947768128575812186728102659050561672566677190244901599510506070318655943628568632914898373548621477256846409976808892481362695861
        ],
        [
            "edge case for computation of x with projective coordinates",
            6611714851403939627066295279236795667020306907521858135292082937429207415403864079386589675694202468981821621482994698369449869189663101522359202161327284,
            4222327554079566377247447198343553986851888849338263796497167682939455868167746580552515463979602120695902232803936738988142169362085166971103478245849808
        ],
        [
            "edge case for computation of x with projective coordinates",
            2681989850692599087067808377764181806352724663965060996783532857356821947591252574610725654769676508933424563343639612797610856413276413718616355846579051,
            4266544495305917519478010615133342743834529517910317060822055934700681863772240409687473155353897366484416187078470736668436673561443214499075311423824186
        ],
        [
            "edge case for computation of y with projective coordinates",
            33764080493681855648349445960823493650064328598275466647281151781484359149420962136070741460916535520425204693690794276649003758584313498532247904362860,
            1275145106602698124616344763887835545869591694833514103164463191419800071714188234129983930237654135227937582107423185498480936526856436347998667063066992
        ],
        [
            "edge case for computation of y with projective coordinates",
            2241476488436397980466614741044634552010794014878040073986591210899765242841989651575820480980132505896669294276760760206570807372870705845470094503914470,
            3786177613938801479577011390142834174534212523593007981136428982763498954003949760764089934432690057981419323859208921856377194003667536797719659666555868
        ],
        [
            "edge case for computation of y with projective coordinates",
            3476859815042337071050108035379006337976271558105430343378161404408390060962237276462422087488019030599037707063391282987307490264275511517803570282087273,
            1498684597792840644544153979011882158414987925771891726123223575543373901923453067522852371988189142840858826298420875200518540866189785266471812619885346
        ],
        [
            "edge case for computation of y with projective coordinates",
            38164086507858655091471760087828607057209576695495015490644143142436253965826018272983812911548193883238315533515584944818923673066403525568988549365370,
            3507762893624433025339785033282092796931028824805644768742456971691835666472449386399735798973375502701996005363727312484425884269933949805633251052054112
        ],
        [
            "point with coordinate x = 3", 3,
            228692746580249040759074125346692218637179467831038638148752542053762243628022949066134078709507760155134305481290706870792835970640886027406843818878870
        ],
        [
            "point with coordinate y = 2",
            6415687018164189949575587339416826492800763534516367543561101835229204040886429691011421761436451130423517669015120765527597090924122102460558527943727469,
            2
        ],
        [
            "point with coordinate y = 3",
            3946314538390236414128374057327618610942307623752908785901835655615994789204605072703624027463903007100879476248452604450681910412482194518209100598124565,
            3
        ]
    ],
    "brainpoolP512t1": [
        [
            "edge case for Jacobian and projective coordinates", 1,
            769770674914853009958835224162967208420389888455640274664051294374265278671428652599050150024415574363810566936997083092041267658059703583803146405334686
        ],
        [
            "edge case for Jacobian and projective coordinates",
            7661796591315423387877616888664208230745031617262902638674207476787221484019937905092668901117116440838446606424986440954448029980904353787419041606901978,
            1355718307945689734273111795630824913080098723205541533214387770818721858672997369298657461653906909413767257750417084665133525315733319287871669689972178
        ],
        [
            "edge case for computation of x with projective coordinates",
            335867052824676950671613211295656301453894264998019985180918934392670044543686249159167616952273258814786283315180569728996354609384040320788146368443326,
            4203661993877851380561148608484221328166764086576473960255687268155293126454045614530231072675717854910596620348319761782116411164953884189806352712898886
        ],
        [
            "edge case for computation of y with projective coordinates",
            8157683513043028999869916628940480991613018212168349260923381707241462895177257515838728765141020359856005520746587768168403694009581373409517280536589179,
            2913640369961458187205815460313763991096317121033386101463582369881099514026374080049614051974611315042981554455375011044815453012250959802844215763942700
        ],
        [
            "edge case for computation of y with projective coordinates",
            4845447903019432826316103342552182340971695879219043566162839550722954044751736960341979683919922072519282949801753919581178527200825187376878704089600438,
            4047586474166658420492530402670635098762090485315320587868414373378044588765698855943056757278046350729601394704054296273047497817988737601865568388755219
        ],
        [
            "edge case for computation of y with projective coordinates",
            5743696261911495351615987633124452573917392025287986383730128240454406911772570697656434656540933093443804670631498258418552682043896153764781524012186934,
            2761753649325541774639820465993920623697819361848634461581410412211921308722137255234223584808337390592996322300911021104842235264622198796146232245029470
        ],
        [
            "point with coordinate x = 3", 3,
            203618184192262530586169149807351720483113189199981009101072360684148872537102998325020331930602071675094899406006559627776199380029085882920998983261540
        ],
        [
            "point with coordinate y = 3",
            2066722026497420140136595606189353224162913173295654744677400845639337420897607268224474846077596095611772114972672659063152264317576000474139866412228229,
            3
        ],
        [
            "point with coordinate y = 3",
            7071845609954263991585158723205221926497361981951851067947907141816656052921147419398126581217232291972453871476855629696957290168957925160465282802929790,
            3
        ],
        [
            "point with coordinate y = 3",
            8759356778848780971591451300923731693664944132949203210063886386944120547008350192213267181089085497946667074323326403115818234133313931437535920000475875,
            3
        ]
    ],
    "secp224k1": [
        [
            "edge case for Jacobian and projective coordinates",
            9123081141391334318075416385891874931179910125674897595002481210834,
            2663280287653449958490643501147616136354638423463245438745986688655
        ],
        [
            "edge case for Jacobian and projective coordinates",
            17836865525759305476591598701127755742457234296865674886096834064283,
            2221818545354696466286701980839090678153383277042002999147124389841
        ],
        [
            "edge case for computation of x with projective coordinates",
            20145694344657778871885780278306560159674064393723445792378132633237,
            8200492333149489822539722928359325368051679737623098703398278315617
        ],
        [
            "edge case for computation of x with projective coordinates",
            14162402259488291920958864813003804575086549498188927836813047494747,
            1065502551467259287086517102271723166716675440776118272003533814939
        ],
        [
            "edge case for computation of y with projective coordinates",
            11052733777150062547467609870882784490171726480293159425257393051920,
            8090398195099622079950190627839665678655839404362564448383471129699
        ],
        [
            "edge case for computation of y with projective coordinates",
            7719858113273878388961569263289097938559494396349725890618530852405,
            3736399714706964304147380101185679705540462037274798599530836953510
        ],
        [
            "point with coordinate x = 2", 2,
            2397706416753043544496583327528397672162763764496095615843766475179
        ],
        [
            "point with coordinate y = 2",
            26959946667150639794667015087019630673637144422540572481099315275116,
            2
        ],
        [
            "point with coordinate y = 2",
            204648378511681579779617035327997059951292977242060151954064178693,
            2
        ],
        [
            "point with coordinate y = 2",
            26755298288638958214887398051691633613685851445298512329145251096425,
            2
        ]
    ],
    "secp224r1": [
        [
            "edge case for Jacobian and projective coordinates",
            23954704978511451250260439608773647871981755072124604006835939868033,
            10232827841857899113088958084092670748386068301602114101245235289527
        ],
        [
            "edge case for Jacobian and projective coordinates",
            3005241688639188544406575478245982801576161187901704136674126430848,
            2469044324867683883438330056258086824711921288428015340556752113782
        ],
        [
            "edge case for Jacobian and projective coordinates",
            8632624864414884920044397170150759308963780010929623110934705672256,
            6480167887444841696230629425564224998455309220262310431222136130049
        ],
        [
            "edge case for Jacobian and projective coordinates",
            6010483377278377088813150956491965603152322375803408273348252861696,
            692137248001201934239553102256847311245376181852201577156327202118
        ],
        [
            "edge case for Jacobian and projective coordinates",
            6714060395763007649280239345825480524207238845713915488169635214880,
            7886185382524240543843559697870861080240868001585391987467563169720
        ],
        [
            "edge case for computation of x with projective coordinates",
            25545167595176227617260958794420214583356437314804716236005157374418,
            2076078288077492085557302075383243009052648764408853882951431745901
        ],
        [
            "edge case for computation of x with projective coordinates",
            18779725942899765844742162430517973716805584336043423984614943520236,
            4893843839422960932638994848004850216792787426887188397957596611229
        ],
        [
            "edge case for computation of y with projective coordinates",
            1525526323245421232974820502132287960991648525580985413351180297238,
            1952909196413996911270536399408381738386754643430724801555469567294
        ],
        [
            "edge case for computation of y with projective coordinates",
            22664282553705289582921197435402232661520842771687635706412418140299,
            5937322931727021232617604021190040409748917836432788708051855057221
        ],
        [
            "point with coordinate x = 3", 3,
            13129542908283142971617175401085520404006047412348784669178454786118
        ],
        [
            "point with coordinate y = 1",
            6249846793029195505132993417681461260653261761075236472107163931605,
            1
        ]
    ],
    "secp256k1": [
        [
            "edge case for Jacobian and projective coordinates",
            40328826357993058471077903774033267338589114616491145646550540576966274128402,
            31329539363330834765554429608644034076209024221532867346084227155882713676540
        ],
        [
            "edge case for Jacobian and projective coordinates",
            75660413511325327053913930325431191114013963031672337494338202657131349278724,
            39099224105886975087153362387921826147885621785678906069272108935083813173911
        ],
        [
            "edge case for computation of x with projective coordinates",
            39939893717475981523486221810780028780883519040742397411776262658269905711037,
            43235005941106822238776029797113220267858218556094465854966590847884892366900
        ],
        [
            "edge case for computation of x with projective coordinates",
            84889144815173763949721897020676568171070094522793864148458694342190535235935,
            52151566017278249709435279260125755692867473517396740624126906491893442451172
        ],
        [
            "edge case for computation of x with projective coordinates",
            54632945126389258645107642468313140231765246451873133036007345322118423943939,
            3046048955680358321321007604841279241644058908718639363648614520651887597676
        ],
        [
            "edge case for computation of y with projective coordinates",
            103486409433594135268846396745216854164591655825131534279743673881542431087225,
            42905485184459196714008169861846327385477129057931685495730911330699828652133
        ],
        [
            "point with coordinate x = 1", 1,
            29896722852569046015560700294576055776214335159245303116488692907525646231534
        ],
        [
            "point with coordinate x = 2", 2,
            46580984542418694471253469931035885126779956971428003686700937153791839982430
        ],
        [
            "point with coordinate x = 3", 3,
            21320899557911560362763253855565071047772010424612278905734793689199612115787
        ],
        [
            "point with coordinate y = 1",
            92132010145575487545665274145875605628664750442204984300260952401046764123763,
            1
        ],
        [
            "point with coordinate y = 1",
            9239253246023934947662416411507919214268280226895293549906036206298523635893,
            1
        ],
        [
            "point with coordinate y = 1",
            14420825845716772930243294451304383010336953996540286189290595400563546912007,
            1
        ]
    ],
    "secp256r1": [
        [
            "edge case for computation of x with projective coordinates",
            60211840854373772748286687376683640744023073420294583336200024423439054702345,
            523615946820694260561144901639903313799248894723905775666485294537022548926
        ],
        [
            "edge case for computation of x with projective coordinates",
            58687076926167833526398910613448791887093835024037337763248351435517941536121,
            52095585056448092084327535138728052592797106431412055157299799799802024215207
        ],
        [
            "edge case for computation of y with projective coordinates",
            30262900477135128491974381569468837605642727614914484099071659187335497736883,
            19853173975010518915446634627083386925474752313208161186239600617330792310634
        ],
        [
            "point with coordinate x = 0", 0,
            46263761741508638697010950048709651021688891777877937875096931459006746039284
        ],
        [
            "point with coordinate y = 1",
            4479932584236123010133496826598814311995915216892401210293766552284834806124,
            1
        ],
        [
            "point with coordinate y = 1",
            63778706158780828310898430985794019439130643576586724611912473313315675296455,
            1
        ],
        [
            "point with coordinate y = 1",
            47533450467339297441665519137014739778959584621811188373327391443266587751372,
            1
        ]
    ],
    "secp384r1": [
        [
            "edge case for Jacobian and projective coordinates",
            20798914130379452305550873316095746929184913568269164570506762495707615271444558119025706579680097256755672633465800,
            15317904589052589776581433129859567868826389862959345145933448064075885009450447391884452681683208260775996449303787
        ],
        [
            "edge case for Jacobian and projective coordinates",
            18603092066015026906728166784047866875894825702196282097441530908538106500052312210021559508578840745105934339646519,
            6500437661825293090534865478624983989066148655006420416191880609069861715609696818310112074858983532200226805908920
        ],
        [
            "edge case for Jacobian and projective coordinates",
            8579044022500196853372761983215784857432202590137646497411576784876471783223999323405635757096073513798221219885059,
            19467669287660484965223002479446781337311541456810354489192571009161463758494849207006536113981535853839124509067162
        ],
        [
            "edge case for Jacobian and projective coordinates",
            39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112318,
            17720153664809162286384094768018186799577366477956087284228583754887974043472116432532980617621641492831213601947059
        ],
        [
            "edge case for Jacobian and projective coordinates",
            27225399140923961894590454748861476540656083692538085245801271145108067848427599786873757036530784052425296744547906,
            13163923059036203631576964161089943283043889309639349912271323008214767094577574845610259519539219746047769980317365
        ],
        [
            "edge case for computation of x with projective coordinates",
            25820628581090237801991734664833280145804504343195817364358412506071428370808624555083755266459422040629560488836292,
            4538326969718646972540512929802738392880378889454798829017575054947665052550819574543074386742622270201993134988682
        ],
        [
            "edge case for computation of x with projective coordinates",
            18844663400098779688510444851340755550624159912177503194705192979869114751509937529454084972306748461325674973039163,
            16798423739188312624443208467580340130040607025305739523818602621755070117515951678796915528461368874456976660344440
        ],
        [
            "edge case for computation of x with projective coordinates",
            1958149430475068796637813113496571363345305045120581146333885729391236421998712170905745553607350418949279856147573,
            17096124940535798252849988464085830520563972985784172073546357110642014566265163931044327499529859254405875583919519
        ],
        [
            "edge case for computation of y with projective coordinates",
            8062943445808415037036367260324819326885159371411706514017590460468640727533648265761305291814449801749406381846418,
            2051469249017491384313738051474850679099682499518209872801082653440113951073432900961956851457234944285013568750191
        ],
        [
            "edge case for computation of y with projective coordinates",
            21408842385188319386342779359338698584034279863432333161722610901510080880018354164894102301734029983758802379004384,
            4541691676315099269234408737507758250151011234763797410966850692107889587555285626725643971964108656709543514564887
        ],
        [
            "edge case for computation of y with projective coordinates",
            13747875584015850093938588656102650290884663094459071061550475791052204493962545383670586642078559175970524188304900,
            14265972363109695378713339792593671910777976373800623083763422186913492835968078062215943870829004392326576647630436
        ],
        [
            "point with coordinate x = 0", 0,
            9384923975005507693384933751151973636103286582194273515051780595652610803541482195894618304099771370981414591681054
        ],
        [
            "point with coordinate x = 2", 2,
            17720153664809162286384094768018186799577366477956087284228583754887974043472116432532980617621641492831213601947059
        ],
        [
            "point with coordinate x = 3", 3,
            15756964269278772761642123637738538983889365853827323282968555926208256374347828962914775757683526799804416294344922
        ],
        [
            "point with coordinate y = 1",
            5291817753639903522650835181246965869806451333116540972570797548842120815583353016199119542988202583424660230855800,
            1
        ],
        [
            "point with coordinate y = 2",
            17879932352066149860679974098947650103841254314332151178118259696108010239309723272947729868497737234488943587103476,
            2
        ],
        [
            "point with coordinate y = 3",
            22405101981350069549501161700642407040607057543040215286609181483865777765349735885591499150092916445286115676911494,
            3
        ],
        [
            "point with coordinate y = 3",
            30516293978131587767772931305200911703127849017415801202206179361751635529659324424833572537125895602289280725528716,
            3
        ],
        [
            "point with coordinate y = 3",
            25882616433307301107283987194443908866424571980474876847081225962874030247984680347669460489299063956147817543784428,
            3
        ]
    ],
    "secp521r1": [
        [
            "edge case for Jacobian and projective coordinates", 1,
            226550527432254644762927155718498869710358906817053425319320865507781004639099725838657309164078643711530506222673069010331048069570407113457901669103973732
        ],
        [
            "edge case for Jacobian and projective coordinates",
            6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057150,
            2911448509017565583245824537994174021964465504209366849707937264041791914820072200944260796359022552605940704016168536472852671910134103604091376779754756815
        ],
        [
            "edge case for computation of x with projective coordinates",
            5564639010822167016183316806086233966100373410057747087996634594464125558179441052712713351443752602367885104751561993899824660987468697538029155027160729209,
            3391385061948721069464926591453977731821910416449479800924866549623702969244755743312507359282675871415960345870097704759387657206564073577122336074802745189
        ],
        [
            "edge case for computation of x with projective coordinates",
            5497177043422528610450035543587826578056498902836346086349583970851224097648835878140051842406163910148022797548761580227021715743057370479047149290684048156,
            1781690414042126645760155299940547054776990283564637032112080997066973392302144448416655360590770391062380830485005313681965922424039000038521883047889656444
        ],
        [
            "edge case for computation of x with projective coordinates",
            2254768401329479364553138652020755984018580942567908337404846571686084590054820231522383672431071783879780346009286666233904851937939130547953433261376453739,
            728503441349785776711084462616263723908292101511513912643591613915950280876569230023249397615511251277103560824311439698124075133933134577190604352580637311
        ],
        [
            "edge case for computation of x with projective coordinates",
            5910583443180981370884711215095277551861909544621480303028878216551375768226654166101116435268182264241456836412521471395746052345295166173175280082604620872,
            196671819675029356479729922160492443376579721085102595534188254311971393787520931561825942230805005340563671949213501973094688099312228632749948838369168022
        ],
        [
            "edge case for computation of y with projective coordinates",
            3659125621176994586371659678139643727404631991176821338631832908955911262624254907176607636149581811587367291436891452556937708351796989834722747076731869120,
            2338337660076151591316935008285059674785104985301002549708795979165430566123280198024402953511418421869698972139083014212568927664010975992207913579160201387
        ],
        [
            "edge case for computation of y with projective coordinates",
            3083804976835526998054218418960878234355116080627025679719877980737298833518546384379440138363429401568135161000984396474100038542838859675355241755787731514,
            1498431058855467622601159721131736314211316087449266657379311127702535322137958038169505576754465014014817158971348501001372454088007323424784599831239841452
        ],
        [
            "edge case for computation of y with projective coordinates",
            3931977883417505785813334760416298482421939907637704728530776439011813381486212104804153375245013126983193398884110920601895216236538154449074944017850120187,
            1767547312429571356028318323060535419767660763573458671031325447114840367407079738858497898027135882265647197581950849081698560873109029794779831816521494291
        ],
        [
            "edge case for computation of y with projective coordinates",
            919832458266586187656796894353569833365583431777870841852558074394400152712049068151745386255798274306271382933308447725291151496013018362020435366899672768,
            2340234347829872845606211575909099942812310657500603268108160892507046597743973899379865633675355061043975798292239949746555236921465121245286454575000102950
        ],
        [
            "point with coordinate x = 0", 0,
            2816414230262626695230339754503506208598534788872316917808418392089468682698289818145417163854114964251706188568952139226053203230035588176689756661142736775
        ],
        [
            "point with coordinate x = 2", 2,
            2911448509017565583245824537994174021964465504209366849707937264041791914820072200944260796359022552605940704016168536472852671910134103604091376779754756815
        ],
        [
            "point with coordinate y = 1",
            2920151293736484050684821025963952603281606086785497383014376647691241154538833554670214870420754676014953260820382850764442744869058362386969828331504750616,
            1
        ],
        [
            "point with coordinate y = 3",
            2800722915865772577889377596336430585632162453795431353373704645782092713680999843535742297351189314072066895194041568391242430116912178520285813377408402835,
            3
        ]
    ]
}
# (x,y) is a valid point on curve1
# (x,y) is not a valid point on curve2, but is a valid point on curve2
# if the parameter b is changed to the value b in the tuples below.
# Additionally (x,y) has a low order on the modified curve.
LOW_ORDER_ALT_CURVE = [
    {
        "curve1":
            "brainpoolP224r1",
        "curve2":
            "brainpoolP224t1",
        "x":
            2950550906586215102813670751370939903037527060764717148440152051433,
        "y":
            5676705029081414553883089598596588675100613555451723814581785063368,
        "b":
            10552830217410942780312382884758201746767698390301847977705951011566,
        "order":
            4
    },
    {
        "curve1":
            "brainpoolP256r1",
        "curve2":
            "brainpoolP256t1",
        "x":
            22424667415675829804466916717349238997998670320838769052081067248963247752989,
        "y":
            33705468607100872444692776679017055747138036471141773053654124124388745800676,
        "b":
            31396656873963027532716835065318769830445012131919485377008518677815587202888,
        "order":
            3
    },
    {
        "curve1":
            "brainpoolP320r1",
        "curve2":
            "brainpoolP320t1",
        "x":
            952083311252680688627175328505965447751471073720820988956198967382172556891634667194537693561618,
        "y":
            768288544286650710276641136700199157541232181397146094159397124524951338817780387697661536657008,
        "b":
            863487106905038598706033932717920011969022741959573238605034064114528754422671252451757781195295,
        "order":
            4
    },
    {
        "curve1":
            "brainpoolP512r1",
        "curve2":
            "brainpoolP512t1",
        "x":
            7996875446468433136714130110115854840554093963907927207665263753139100174959162291470138178076912869035239190655863704977082620128324276215106493423219517,
        "y":
            514669796092722828028567656617639688635136444527090724559127188041268108667500716093646087289683894245269435048649367263837670869290888798362052857146221,
        "b":
            784351574842023925825723312937795425312465062057309964240202102175249393511902614179542307428121833322255015480088385659750731073501935921183028894189827,
        "order":
            3
    },
    {
        "curve1":
            "brainpoolP512r1",
        "curve2":
            "brainpoolP512t1",
        "x":
            404500359388555162154264968642538082935304390797496647324374001317222720848503851914536610257602303124292342898380815629048190492600067394263798400848644,
        "y":
            2284858673143359227317493345651090875709932345810244996977739716216489566113060617897650649756064958974541809736688910365047745585258339221493602777068606,
        "b":
            2289133368480112969151434880328488250286238196206214315583205856908056542411435726003470899232953239137428967743751178369647381408937305417963334360060733,
        "order":
            3
    },
    {
        "curve1":
            "brainpoolP512r1",
        "curve2":
            "brainpoolP512t1",
        "x":
            75767983340569677305913088450092160760640479821322790069857957188604354634775733678111867925805028140468124298871788011767745601817545690732087912758581,
        "y":
            1353163353551919463274670169493337860611780783623497366509048012199448213014489578841797355886877188090542811027413832351779857095167470638540976741345180,
        "b":
            6441188571413509584860080140274821260169925597555331982820318210921596244249139004462480758767486323573803004506676040352110338697562269907584361793909196,
        "order":
            3
    },
    {
        "curve1":
            "brainpoolP256t1",
        "curve2":
            "brainpoolP256r1",
        "x":
            51493263388075037145801904962622597885827349760555231104673625004609305641874,
        "y":
            8035357244180161612841857973046023657594202588509300702890970861188350492478,
        "b":
            25944743547036531437652945678955783499386036214750663788919384475286354645905,
        "order":
            3
    },
    {
        "curve1":
            "brainpoolP256t1",
        "curve2":
            "brainpoolP256r1",
        "x":
            12500807802880694213223087822770471158089909626064440525222601122537839513080,
        "y":
            34716099776195016058719929919489900958801255112257266216578954712671149746072,
        "b":
            30963138881736371836701448804031778908213618626556983324530544883931857672437,
        "order":
            4
    },
    {
        "curve1":
            "brainpoolP384t1",
        "curve2":
            "brainpoolP384r1",
        "x":
            1843152000778097454799775293926936652513545280283149733021176522105012935473587924039305419700103288781083673357835,
        "y":
            1461262587929303624708040443940977865749673550076737275101202668403418402630649928254614861950946002240929451691673,
        "b":
            5496477817487194302092377030854484220074840319930929511059377088518082020193092252801126110491416324128259831984842,
        "order":
            3
    },
    {
        "curve1":
            "brainpoolP384t1",
        "curve2":
            "brainpoolP384r1",
        "x":
            5274884192465871964145712439358790463749436965703999650582963352958998200254418333131503942477521649677193190705672,
        "y":
            5050001401975752998051502458396206772688963369498246386711041682123935890289964168375174620419956849973637879980615,
        "b":
            5720703299933010671599979442263897982054610796157108158755440586909174733385310631836073872228829285557015359149874,
        "order":
            3
    },
    {
        "curve1":
            "brainpoolP384t1",
        "curve2":
            "brainpoolP384r1",
        "x":
            3653864670276563915320401317373376856719033727367902512354558175163431235368679790245581284267564232623241710049302,
        "y":
            8443863770061659027459842250501550074869004610623189949075392875660312991005910576894083450801516749103427388806889,
        "b":
            7883900655386214541633527049490774306040220715940089769203088985694156208758425829589538434629020317092491695719307,
        "order":
            4
    },
    {
        "curve1":
            "brainpoolP384t1",
        "curve2":
            "brainpoolP384r1",
        "x":
            14782274450157361512804957874572030695240675557821695313135608120629146809529536001295171489673945861641615488338355,
        "y":
            360506391724934724423081781942398659292670955715071937129322578743303586392941763511603636613975560478873184962149,
        "b":
            19591551577039066688565895137767160830179717576829335837581083018245157035237124148710000782366463244285635568569644,
        "order":
            4
    },
    {
        "curve1":
            "brainpoolP512t1",
        "curve2":
            "brainpoolP512r1",
        "x":
            3676526863000710138668516242696358462879080759322926649822765934492315063271128928237041016340685269372318503549545779211207292090715949233200522235894833,
        "y":
            2387144583335714935297275446291559627810181522405745786875467682703831607733534405462249292907833885998674820690632869237858601582545947978111932229083969,
        "b":
            7699832468016960715400599363541634238365588843056888723396764630740705101704752721186311156209811161056640231151049742831600051987002492770742364636870382,
        "order":
            3
    },
    {
        "curve1":
            "brainpoolP512t1",
        "curve2":
            "brainpoolP512r1",
        "x":
            3206282350489045436876891921344733747585699319070882910291132053308872435725647864546248812270851280999702754242692752176309718182724139636749760950388080,
        "y":
            1337965364632695527517495604182922619119528648304197490847728384739769098221018204156764019799155781646491977267795504426095435686548206408295450866908091,
        "b":
            4053712124766184978421926025601774888587956098319013166957660826326907668296752377081991332271287498410142912550846840597963113245030403448500256145610547,
        "order":
            4
    },
    {
        "curve1":
            "brainpoolP512t1",
        "curve2":
            "brainpoolP512r1",
        "x":
            3128343982780236594087547925753884451064624298661922420849052868118395345675895162806514777363882618524782073113126830028151784049747427544818339531866566,
        "y":
            2880585618766242837076168509646310659851237051649225373372218239976497122272516229081439399877387964770638334084568515724603694904310439031169427228158968,
        "b":
            3195517151745916419827641830159616016413140528396776557456056541658785161019905631807864729621005257777716140927707758415107114831937519427605863479544959,
        "order":
            4
    },
]

comments = {
    "minx:" : "x-coordinate of the public key is small",
    "maxx:" : "x-coordinate of the public key is large",
    "miny:" : "y-coordinate of the public key is small",
    "maxy:" : "y-coordinate of the public key is large",
    "lzx:"  : "x-coordinate of the public key has many trailing 1's",
    "lzy:"  : "y-coordinate of the public key has many trailing 1's",
    "lbx:"  : "x-coordinate of the public key has many trailing 0's",
    "lby:"  : "y-coordinate of the public key has many trailing 0's",
}

def edge_case_ec_keys0(groups):
  edge_case_public = flag.Flag(
      label="EdgeCasePublicKey",
      bug_type=flag.BugType.EDGE_CASE,
      description="The test vector uses a special case public key. ")
  for group, keys in EDGE_CASE_EC_KEYS :
    if group in groups:
      for desc, privkey, val in keys:
        if desc in comments:
          comment = comments[desc]
        else:
          comment = desc
        yield group, privkey, comment, [edge_case_public]
        if desc == "miny:":
          pk2 = group.n - privkey
          yield group, pk2, comments["maxy:"], [edge_case_public]

def edge_case_ec_keys(groups):
  """An iterator that returns a quadruple (ecGroup, privkey, comment, flags)
     such that the public key corresponding to the private key privkey
     has special properties. ecGroup is an EcGroup, privkey is an integer,
     comment describes the special property, flags contains a list of flags
     containg additional comments in footnote format."""
  for val in edge_case_ec_keys0(groups):
    yield val
  isomorphisms = [i for i in ec_groups.isomorphisms if i.A in groups]
  if isomorphisms:
    group_isomorphism = flag.Flag(
        label="GroupIsomorphism",
        bug_type=flag.BugType.EDGE_CASE,
        description="Some EC groups have isomorphic groups that allow an "
        "efficient implementation. "
        "This is a test vector that contains values that are edge "
        "cases on an isomorphic group.")
    iso_groups = [i.B for i in isomorphisms]
    for group, key, comment, flags in edge_case_ec_keys0(iso_groups):
      for i in isomorphisms:
        if i.B == group:
          yield i.A, key, comment + " on " + i.B.name, flags + [group_isomorphism]

def special_ec_points0(group):
  for g, points in EDGE_CASE_EC_POINTS :
    if g == group:
      for desc, pt, val in points:
        if desc in comments:
          comment = comments[desc]
        else:
          comment = desc
        yield pt, comment, []
        if desc == "miny:":
          x,y = pt
          y2 = -y % group.p
          yield (x,y2), comments["maxy:"], []


@util.type_check
def special_ec_points(
    group: ec_groups.EcGroup
) -> Iterator[tuple[tuple[int, int], str, list[flag.Flag]]]:
  """An iterator that yields special EC points.

  The iterator yields tuples (point, comment, flag),
  such that the public key corresponding to the private key privkey
  has special properties. ecGroup is an EcGroup, privkey is an integer,
  comment describes the special property, flags contains a list of flags
  containg additional comments in footnote format.
  """

  group_isomorphism = flag.Flag(
      label="GroupIsomorphism",
      bug_type=flag.BugType.EDGE_CASE,
      description="Some EC groups have isomorphic groups that allow an "
      "efficient implementation. "
      "This is a test vector that contains values that are edge "
      "cases on an isomorphic group.")
  for val in special_ec_points0(group):
    yield val
  for i in ec_groups.isomorphisms:
    if i.A == group:
      for pt, comment, flags in special_ec_points0(i.B):
        pb = i.B.get_point(*pt)
        pa = i.fromBtoA(pb)
        cmt = comment + " on " + i.B.name
        yield (pa.affine(), cmt, flags + [group_isomorphism])
    if i.B == group:
      for pt, comment, flags in special_ec_points0(i.A):
        pa = i.A.get_point(*pt)
        pb = i.fromAtoB(pa)
        cmt = comment + " on " + i.A.name
        yield (pb.affine(), cmt, flags + [group_isomorphism])

def special_ec_points_doubling(group):
  """An iterator that returns a triple (point, comment, flags),
     where point is an edge case for point doubling."""

  edge_case_doubling = flag.Flag(
      label="EdgeCaseDoubling",
      bug_type=flag.BugType.EDGE_CASE,
      description="The test vector contains an EC point that hits "
      "an edge case (e.g. a coordinate 0) when doubled. "
      "The goal of the test vector is to check for arithmetic errors "
      "in these test cases.",
      effect="The effect of such arithmetic errors is unclear and "
      "requires further analysis.")
  if group.name in EDGE_CASE_POINTS_DOUBLING:
    for comment, x, y in EDGE_CASE_POINTS_DOUBLING[group.name]:
      yield (x, y), comment, [edge_case_doubling]

def shared_points(group1, group2):
  """Yields points that are both on the curves of group1 and group2.

  Tries to find points (x, y) that are both on group1 and group.
  The result does not include the point at infinity. There is no
  guarantee that the result is complete.
  Args:
    group1: an elliptic curve group over a prime field
    group2: another elliptic curve group over a prime field
  Yields:
    points both on group1 and group2
  """
  p1, p2 = group1.p, group2.p
  if p1 == p2:
    a1, b1 = group1.a, group1.b
    a2, b2 = group2.a, group2.b
    # The point must satisfy
    # y^2 = x^3 + a1 x + b1 (mod p) and y^2 = x^3 + a2 x + b2 (mod p)
    # Hence a1 x + b1 = a2 x + b2 (mod p)
    if a1 == a2:
      return
    x = (b2 - b1) * pow(a1 - a2, -1, p1) % p1
    y = group1.get_y(x)
    if y is not None:
      yield (x, y)
      if y:
        yield (x, p1 - y)
  else:
    # I don"t have a method for finding points if the fields
    # are different.
    return

def special_ec_points_alt_group(group):
  """Yields points of low order in alternative groups.

  The point (x, y) is a valid point on curve1.
  It is not a valid point on curve2, but it is low order
  point on curve2 with modified b.
  """
  for rec in LOW_ORDER_ALT_CURVE:
    if rec["curve1"] == group.name:
      yield (rec["x"], rec["y"]), rec["curve2"], rec["order"]


def test_ec():
  for c, points in EDGE_CASE_EC_POINTS:
    for cmt, pt, cnt in points:
      c.get_point(*pt)
  for n, points in EDGE_CASE_POINTS_DOUBLING.items():
    c = ec_groups.named_curve(n)
    for cmt, x, y in points:
      c.get_point(x, y)

if __name__ == "__main__":
  test_ec()
